<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="learn everday," />










<meta name="description" content="WPF ClassicWPF Introduction1.4 WPF体系结构Core ClassSystem.Threading.DispatcherObject 单线程亲和模型  继承自DispatcherObject类，可以让界面元素检查代码是否在正确的线程上运行 System.Windows.DependencyObject 依赖属性 System.Windows.Media.Visual">
<meta name="keywords" content="learn everday">
<meta property="og:type" content="article">
<meta property="og:title" content="WPF pro 4.5 Top">
<meta property="og:url" content="http://yoursite.com/2018/06/21/WPF-pro-4-5-Top/index.html">
<meta property="og:site_name" content="Psmyfish">
<meta property="og:description" content="WPF ClassicWPF Introduction1.4 WPF体系结构Core ClassSystem.Threading.DispatcherObject 单线程亲和模型  继承自DispatcherObject类，可以让界面元素检查代码是否在正确的线程上运行 System.Windows.DependencyObject 依赖属性 System.Windows.Media.Visual">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-06-21T10:24:04.055Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WPF pro 4.5 Top">
<meta name="twitter:description" content="WPF ClassicWPF Introduction1.4 WPF体系结构Core ClassSystem.Threading.DispatcherObject 单线程亲和模型  继承自DispatcherObject类，可以让界面元素检查代码是否在正确的线程上运行 System.Windows.DependencyObject 依赖属性 System.Windows.Media.Visual">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/06/21/WPF-pro-4-5-Top/"/>





  <title>WPF pro 4.5 Top | Psmyfish</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Psmyfish</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">what is this fish?</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/WPF-pro-4-5-Top/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Psmyfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Psmyfish">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">WPF pro 4.5 Top</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-21T18:22:25+08:00">
                2018-06-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="WPF-Classic"><a href="#WPF-Classic" class="headerlink" title="WPF Classic"></a>WPF Classic</h1><h2 id="WPF-Introduction"><a href="#WPF-Introduction" class="headerlink" title="WPF Introduction"></a>WPF Introduction</h2><h3 id="1-4-WPF体系结构"><a href="#1-4-WPF体系结构" class="headerlink" title="1.4 WPF体系结构"></a>1.4 WPF体系结构</h3><h6 id="Core-Class"><a href="#Core-Class" class="headerlink" title="Core Class"></a>Core Class</h6><p>System.Threading.DispatcherObject</p>
<p>单线程亲和模型 </p>
<p>继承自DispatcherObject类，可以让界面元素检查代码是否在正确的线程上运行</p>
<p><strong>System.Windows.DependencyObject</strong></p>
<p>依赖属性</p>
<p><strong>System.Windows.Media.Visual</strong>   class</p>
<p>可将Visual类视为绘图对象</p>
<p><strong>System.Windows.UIElement</strong>  class</p>
<p>增加了对WPF本质特征的支持</p>
<p><strong>System.Windows.FrameworkElement</strong> Clas</p>
<p>HorizontalAlignment </p>
<p>Margin</p>
<p>Animation</p>
<p>Style</p>
<p>etc.</p>
<p><strong>System.Windows.Shapes.Shape</strong> Class</p>
<p>形状类 Rectangle  Polygon  Ellipse  Line  Path</p>
<p><strong>System.Windows.Controls.Control</strong>      Class</p>
<p>Control :   TextBox  Button ListBox  </p>
<p><strong>System.Windows.Controls.ContentControl</strong></p>
<p>是所有具有单一内容的控件的基类</p>
<p><strong>System.Windows.Controls.ItemsControl</strong></p>
<p>所有显示选项集合的控件的基类  ListBox  or TreeView</p>
<p><strong>System.Windows.Controls.Panel</strong></p>
<p>所有布局容器的基类</p>
<h3 id="1-6-Conclusion"><a href="#1-6-Conclusion" class="headerlink" title="1.6 Conclusion"></a>1.6 Conclusion</h3><ul>
<li>硬件加速</li>
<li>分辨率无关性</li>
<li>控件无固定外观</li>
<li>声明式用户界面</li>
<li>基于对象的绘图</li>
</ul>
<h2 id="XAML"><a href="#XAML" class="headerlink" title="XAML"></a>XAML</h2><h3 id="2-2-XAML-basic"><a href="#2-2-XAML-basic" class="headerlink" title="2.2 XAML basic"></a>2.2 XAML basic</h3><p>顶级元素</p>
<ul>
<li>Window</li>
<li>Page</li>
<li>Application</li>
</ul>
<p>Xaml生成的是partial类 与C#定义合为一个类</p>
<p>InitializeComponent（） 是默认的构造函数，工作是调用LoadComponent（）方法</p>
<p><grid x:name="grid1"> 和<grid name="grid1">等价？</grid></grid></p>
<h2 id="2-3-Xaml中的属性和事件"><a href="#2-3-Xaml中的属性和事件" class="headerlink" title="2.3 Xaml中的属性和事件"></a>2.3 Xaml中的属性和事件</h2><p>XML的特性值总是纯文本字符串，但是对象可以是任何.net类型，因此需要用到类型转换器执行转换 TypeConverter</p>
<p><strong>复杂属性</strong></p>
<p>属性元素语法</p>
<p>标记扩展 {标记扩展类 参数} 语法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">...</span> <span class="attr">Foreground</span>=<span class="string">"&#123;x:Static SystemColors.ActiveCaptionBrush&#125;"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>==</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button.Foreground</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">x:Static</span> <span class="attr">Member</span>=<span class="string">"SystemColors.ActiveCaptionBrush"</span>&gt;</span><span class="tag">&lt;/<span class="name">x:Static</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Button.Foreground</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>Attached Property</strong></p>
<p>附加属性是可用于多个控件但在另一个类中定义的属性。在WPF中，附加属性常用于控件布局</p>
<p><button grid.row="0">…  其中Grid.Row就是附加属性，解析器执行一下代码</button></p>
<p><code>Grid.SetRow(texQuestion,0)</code></p>
<p>包含句点的 LinearGradientBrush.GradientStops是复杂属性。如果复杂属性实现了IList或者IDictionary接口</p>
<p>解释器就使用IList.Add()方法添加对象</p>
<p>xaml 字符实体</p>
<table>
<thead>
<tr>
<th>coma</th>
<th>write</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;</td>
<td>&amp;lt  ;</td>
</tr>
<tr>
<td>&gt;</td>
<td>&amp;gt  ;</td>
</tr>
<tr>
<td>&amp;</td>
<td>&amp;amp  ;</td>
</tr>
<tr>
<td>引号</td>
<td>&amp;quot ;</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h2 id="WFP-Layout"><a href="#WFP-Layout" class="headerlink" title="WFP Layout"></a>WFP Layout</h2><h6 id="Panel"><a href="#Panel" class="headerlink" title="Panel"></a>Panel</h6><p>public properties</p>
<p>Background Children IsItemsHost</p>
<p><strong>Classes</strong></p>
<p>StackPanel</p>
<p>WrapPanel</p>
<p>DockPanel</p>
<p>Grid</p>
<p>UniformGrid</p>
<p>Canvas</p>
<p>TabPanel</p>
<p>ToobarPanel</p>
<p>VirtualizingStackPanel</p>
<p>InkCanvas</p>
<h3 id="3-2Layout-Property"><a href="#3-2Layout-Property" class="headerlink" title="3.2Layout Property"></a>3.2Layout Property</h3><h4 id="3-2-1"><a href="#3-2-1" class="headerlink" title="3.2.1"></a>3.2.1</h4><p>HorizontalAlignment</p>
<p>VerticalAlignment</p>
<p>Margin</p>
<p>MinWidth MinHeight</p>
<p>MaxWidth  MaxHeight</p>
<p>Width Height</p>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><h2 id="4-Dependency-Properties"><a href="#4-Dependency-Properties" class="headerlink" title="4.Dependency Properties"></a>4.Dependency Properties</h2><p>You can use Reflector to do it;</p>
<h3 id="Routed-Events"><a href="#Routed-Events" class="headerlink" title="Routed Events"></a>Routed Events</h3><p>The Coercion Callback</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">FrameworkPropertyMetadata metadata = new FrameworkPropertyMetadata();</span><br><span class="line">metadata.CoerceValueCallback = new CoerceValueCallback(CoerceMaximum);</span><br><span class="line">DependencyProperty.Register(&quot;Maximum&quot;,typeof(double),typeof(RangeBase),metadata);</span><br><span class="line"></span><br><span class="line">private static object CoerceMaximum(DependencyObject d,object value)</span><br><span class="line">&#123;</span><br><span class="line">	RangeBase base1= (RangeBase)d;</span><br><span class="line">	if(((double)value)&lt;base1.Minimum)</span><br><span class="line">	&#123;</span><br><span class="line">		return base1.Minimum;</span><br><span class="line">	&#125;</span><br><span class="line">	return value;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">internal static object ConstrainToRange(DependencyObject d,object value)</span><br><span class="line">&#123;</span><br><span class="line">	double newValue =(double)value;</span><br><span class="line">	RangeBase base1=(RangeBase)d;</span><br><span class="line"></span><br><span class="line">	double minimum=base1.Minimum;</span><br><span class="line">	if(newValue&lt;minimum)</span><br><span class="line">		return minimum;</span><br><span class="line"></span><br><span class="line">	double maximum=base1.maximum;</span><br><span class="line">	if(newValue&gt;maximum)</span><br><span class="line">	&#123;</span><br><span class="line">		return maximum;</span><br><span class="line">	&#125;</span><br><span class="line">	return newValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private static void OnMinimumChanged(DependencyObject d,DependencyPropertyChangedEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">	RangeBase base1 =(RangeBase)d;</span><br><span class="line">	...</span><br><span class="line">	base1.CoerceMaximum(RangeBase.MaximumProperty);</span><br><span class="line">	base1.CoerceValue(RangeBase.ValueProperty);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private static void OnMaximumChanged(DependencyObject d,DependencyPropertyChangedEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">	RangeBase base1=(RangeBase)d;</span><br><span class="line">	...</span><br><span class="line">	base1.CoerceValue(RangeBase.ValueProperty);</span><br><span class="line">	base1.OnMaximumChanged((double) e.OldValue,(double)e.NewValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-2-1-RoutedEventArgs"><a href="#5-2-1-RoutedEventArgs" class="headerlink" title="5.2.1 RoutedEventArgs"></a>5.2.1 RoutedEventArgs</h4><p>Properties:</p>
<p>Source</p>
<p>OriginalSource</p>
<p>RoutedEvent</p>
<p>Handled</p>
<h4 id="Attached-Events"><a href="#Attached-Events" class="headerlink" title="Attached Events"></a>Attached Events</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Button.Click</span>=<span class="string">"DoSomething"</span> <span class="attr">Margin</span>=<span class="string">"5"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span>&gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The Click Event is actually defined in the ButtonBase Class…</p>
<p>代码中关联附加事件时 不能用+=</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnlButtons.AddHandler(Button.Click,new RoutedEventHandler(DoSomething));</span><br></pre></td></tr></table></figure>
<h3 id="WPF-EVents"><a href="#WPF-EVents" class="headerlink" title="WPF EVents"></a>WPF EVents</h3><p>events catagories:</p>
<p>Lifetime events</p>
<p>Mouse events</p>
<p>Keyboard events</p>
<p>Stylus events</p>
<p>Multitouch events</p>
<h4 id="Lifetime-Events"><a href="#Lifetime-Events" class="headerlink" title="Lifetime Events"></a>Lifetime Events</h4><p>Initialized</p>
<p>Loaded</p>
<p>Unloaded</p>
<p>For Window</p>
<p>SourceInitialized</p>
<p>ContentRendered</p>
<p>Activated</p>
<p>Deactivated</p>
<p>Closing</p>
<p>Closed</p>
<h4 id="Input-Events"><a href="#Input-Events" class="headerlink" title="Input Events"></a>Input Events</h4><h3 id="Keyboard-Input"><a href="#Keyboard-Input" class="headerlink" title="Keyboard Input"></a>Keyboard Input</h3><h4 id="Handling-a-Key-Press"><a href="#Handling-a-Key-Press" class="headerlink" title="Handling a Key Press"></a>Handling a Key Press</h4><h4 id="Focus"><a href="#Focus" class="headerlink" title="Focus"></a>Focus</h4><h4 id="Getting-Key-State"><a href="#Getting-Key-State" class="headerlink" title="Getting Key State"></a>Getting Key State</h4><h3 id="Mouse-Input"><a href="#Mouse-Input" class="headerlink" title="Mouse Input"></a>Mouse Input</h3><p>MouseEventArgs   —–a little like Transform</p>
<h3 id="Multitouch-Input"><a href="#Multitouch-Input" class="headerlink" title="Multitouch Input"></a>Multitouch Input</h3><h3 id="The-last-world"><a href="#The-last-world" class="headerlink" title="The last world"></a>The last world</h3><h2 id="Controls"><a href="#Controls" class="headerlink" title="Controls"></a>Controls</h2><h3 id="The-Control-Class"><a href="#The-Control-Class" class="headerlink" title="The Control Class"></a>The Control Class</h3><h4 id="Background-and-Foreground"><a href="#Background-and-Foreground" class="headerlink" title="Background and Foreground"></a>Background and Foreground</h4><p><strong>Setting Colors in Code</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cmd.Background = new SolidColorBrush(Colors.AliceBlue);</span><br><span class="line">cmd.Background = new SolidColorBrush(SystemColors.ControlColor);</span><br><span class="line">cmd.Background = SystemColors.ControlBrush;</span><br><span class="line">int red=0;int green=255;int blue =0;</span><br><span class="line">cmd.Foreground = new SolidColorBrush(Color.FromRgb(red,green,blue));</span><br><span class="line">cmd.Foreground = new SolidColorBrush(Color.FromArgb(red,green,blue.0.5));</span><br></pre></td></tr></table></figure>
<h4 id="Fonts"><a href="#Fonts" class="headerlink" title="Fonts"></a>Fonts</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">Name</span>=<span class="string">"cmd"</span> <span class="attr">FontFamily</span>=<span class="string">"Times New Roman"</span> <span class="attr">FontSize</span> =<span class="string">"18"</span>&gt;</span>A Button<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Same as</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmd.FontFamily =&quot;Times New Roman&quot;;</span><br><span class="line">cmd.FontSize=&quot;18&quot;;</span><br></pre></td></tr></table></figure>
<p><code>&lt;TextBlock TextDecorations=&quot;Underline&quot;&gt;Underlined text&lt;/TextBlock&gt;</code></p>
<h4 id="Mouse-Cursors"><a href="#Mouse-Cursors" class="headerlink" title="Mouse Cursors"></a>Mouse Cursors</h4><h4 id="Fonts-1"><a href="#Fonts-1" class="headerlink" title="Fonts"></a>Fonts</h4><p>文本格式化模式，字体低于15时，可以使用GDI风格的文本渲染，增加TextOptions.TextFormattingMode附加属性，并且设置为Display</p>
<p><code>TextOptions.TextFormattingMode=&quot;Display&quot;</code></p>
<h4 id="Mouse-Cursors-1"><a href="#Mouse-Cursors-1" class="headerlink" title="Mouse Cursors"></a>Mouse Cursors</h4><p><code>&lt;Button Cursor=&quot;Help&quot;&gt;Help&lt;/Button&gt;</code></p>
<p>重叠光标，内部也是可以的</p>
<p>ForceCursor属性，可以使父元素覆盖子元素的光标</p>
<p>如果希望为应用程序每个窗口中的每个元素应用光标设置，则使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mouse.OverrideCursor =Cursors.Wait;</span><br><span class="line">Mouse.OverrideCursor = null;</span><br></pre></td></tr></table></figure>
<p>自定义光标也是可以的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cursor customCursor = new Cursor(Path.Combine(applicationDir,&quot;stopwatch.ani&quot;));</span><br><span class="line">this.Cursor =customCursor;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">StreamResourceInfo sri =Application.GetResourcesStream(</span><br><span class="line">new Uri(&quot;stopwatch.ani&quot;,UriKind.Relative));</span><br><span class="line">Cursor customCursor = new Cursor(sri.Stream);</span><br><span class="line">this.CUrsor =customCursor;)</span><br></pre></td></tr></table></figure>
<h3 id="Content-Controls"><a href="#Content-Controls" class="headerlink" title="Content Controls"></a>Content Controls</h3><h4 id="6-2-1-Content-属性"><a href="#6-2-1-Content-属性" class="headerlink" title="6.2.1 Content 属性"></a>6.2.1 Content 属性</h4><p>Control类有Content属性支持两大类</p>
<ul>
<li>未继承自UIElement类的对象 使用ToString()显示文本</li>
<li>继承自UIElement类的对象 使用UIElement.OnRender()显示文本</li>
</ul>
<p><strong>Check Box</strong></p>
<p>是可空类型，接口实现于ToggleButton类,IsChecked~~于是属性可以设置为 true/false null</p>
<p><code>&lt;CHeckBox IsChecked=&quot;{x:Null}&quot;&gt;A Check box in indeterminate state&lt;/CheckBox&gt;</code></p>
<p>IsThreeState:决定用户是否能把复选框设置为不确定状态</p>
<p><strong>RadioButton</strong></p>
<p>通常用GroupBox封装 单选按钮</p>
<p><strong>Tooltips</strong></p>
<p>ToolTip属性在FrameworkElement类中定义，所有能放窗口的元素都可以使用该属性</p>
<p><code>&lt;Button ToolTip=&quot;This is my tooltip&quot;&gt;I have a tooltip&lt;/Button&gt;</code></p>
<p>ToolTip不能接收焦点</p>
<p>Properties:</p>
<p>HasDropShadow</p>
<p>Placement</p>
<p>HorizontalOffset</p>
<p>VerticalOffset</p>
<p>PlacementTarget</p>
<p>PlacementRectangle</p>
<p>CustomPopupPlace</p>
<p>ToolTip放置策略有一堆</p>
<p>ToolTipService  附加属性</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">ToolTipService.InitialShowDelay</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Properties:</p>
<p>InitialShowDelay</p>
<p>ShowDuration</p>
<p>BetweenShowDelay</p>
<p>Tooltip</p>
<p>HasDropShadow</p>
<p>ShowOnDisabled</p>
<p>Placement/PlacementTarget/</p>
<p>PlacementRectangle/VerticallOffset</p>
<p><strong>The Popup</strong></p>
<p> 与Tooltop区别更重要</p>
<ul>
<li>Popup控件永远不会自动显示。要显示要用IsOpen</li>
<li>默认情况下Popup.StaysOpen属性被设置为true，直到明确地设置IsOpen属性为false</li>
<li>Popup 提供PopupAnimation属性，如果IsOpen为true，可以控制Popup进入视野的方式。可以选择None Fade   Scroll  以及Slide 为了使用动画，设置AllowsTransparency属性为true</li>
<li>可以接收焦点</li>
<li>定义在System.Windows.Controls.Primitive</li>
</ul>
<h3 id="6-3-Specialized-Containers"><a href="#6-3-Specialized-Containers" class="headerlink" title="6.3 Specialized Containers"></a>6.3 Specialized Containers</h3><h4 id="6-3-1-ScrollViewer"><a href="#6-3-1-ScrollViewer" class="headerlink" title="6.3.1  ScrollViewer"></a>6.3.1  ScrollViewer</h4><p>VerticalScrollBarVisibility属性控制滚动条显示</p>
<p><strong>自定义滚动</strong></p>
<ol>
<li>在ScrollViewer控件中放置能滚动的元素，即实现了IScrollInfo的元素</li>
<li>设置ScrollViewer.CanContentScroll</li>
<li>自定义滚动</li>
</ol>
<p>实现了IScrollInfo 接口的元素很少，如StackPanel，如果设置CanContentScroll属性为true,则从元素滚到元素，否则像素滚</p>
<h4 id="6-3-2-GroupBox"><a href="#6-3-2-GroupBox" class="headerlink" title="6.3.2  GroupBox"></a>6.3.2  GroupBox</h4><h4 id="6-3-3-TabItem"><a href="#6-3-3-TabItem" class="headerlink" title="6.3.3  TabItem"></a>6.3.3  TabItem</h4><h4 id="6-3-4-Expander"><a href="#6-3-4-Expander" class="headerlink" title="6.3.4 Expander"></a>6.3.4 Expander</h4><p>折叠扩展，可以设置IsExpanded来改变是否折叠</p>
<p>与其他控件同步，可处理Expanded和Collapsed事件</p>
<p>内容太多需要拓展时。</p>
<ol>
<li>为窗口设置最小尺寸</li>
<li>设置SizeToContent属性</li>
<li>hard-coding height and width</li>
<li>Create a scrollable expandable region by ScrollViewer</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Expander</span> <span class="attr">Margin</span>=<span class="string">"5"</span> <span class="attr">Padding</span>=<span class="string">"5"</span> <span class="attr">Header</span>=<span class="string">"Region Two"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ScrollViewer</span> <span class="attr">Height</span>=<span class="string">"50"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">TextWrapping</span>=<span class="string">"Wrap"</span>&gt;</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="tag">&lt;/<span class="name">TextBlock</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ScrollViewer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Expander</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="6-3-5-Text-Controls"><a href="#6-3-5-Text-Controls" class="headerlink" title="6.3.5 Text Controls"></a>6.3.5 Text Controls</h4><h4 id="6-3-6-Multiple-Lines-of-Text"><a href="#6-3-6-Multiple-Lines-of-Text" class="headerlink" title="6.3.6 Multiple Lines of Text"></a>6.3.6 Multiple Lines of Text</h4><p>use the handy MinLines and MaxLines properties </p>
<p>use IsReadOnly property or IsEnabled…Think</p>
<h4 id="6-3-7-Text-Selection"><a href="#6-3-7-Text-Selection" class="headerlink" title="6.3.7 Text Selection"></a>6.3.7 Text Selection</h4><p>TextBox property  SelectionStart   SelectionLength  SelectedText</p>
<p>AutoWordSelection.–直接全选</p>
<p>Undo()     CanUndo</p>
<h4 id="Spell-Checking"><a href="#Spell-Checking" class="headerlink" title="Spell Checking"></a>Spell Checking</h4><p><code>&lt;TextBox SpellCheck.IsEnabled=&quot;True&quot;&gt;...&lt;/TextBox&gt;</code></p>
<h4 id="6-3-8-PasswordBox"><a href="#6-3-8-PasswordBox" class="headerlink" title="6.3.8 PasswordBox"></a>6.3.8 PasswordBox</h4><p>Like TextBox has property MaxLength    Method: Clear() Paste()  SelectAll()  </p>
<p>Event: PasswordChange</p>
<p>using  System.Security.SecureString       Object</p>
<p>SecureString.Dispose()</p>
<h3 id="6-5-List-Controls"><a href="#6-5-List-Controls" class="headerlink" title="6.5 List Controls"></a>6.5 List Controls</h3><p>event SelectionChanged</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">private void lst_SelectionChanged(object sender,SelectionChangedEventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    if(lst.SelectedItem==null ) return;</span><br><span class="line">    txtSelection.Text=String.Format(</span><br><span class="line">    &quot;You chose item at Position&#123;0&#125;.\r\nChecked state is &#123;1&#125;&quot;,</span><br><span class="line">    lst.SelectedIndex,((CheckBox)lst.SelectedItem).IsCHecked);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SelectedItem  读取</p>
<h4 id="6-5-2-ComboBox"><a href="#6-5-2-ComboBox" class="headerlink" title="6.5.2 ComboBox"></a>6.5.2 ComboBox</h4><p>下拉框</p>
<h3 id="6-6-Range-based-Controls"><a href="#6-6-Range-based-Controls" class="headerlink" title="6.6 Range_based Controls"></a>6.6 Range_based Controls</h3><p>Including ScrollBar/  ProgressBar / Slider     inherited from RangeBase Class which is from Control class</p>
<p>RangeBase  Properties</p>
<p>Value</p>
<p>Maximum</p>
<p>Minimum</p>
<p>SmallChange</p>
<p>LargeChange</p>
<p>通常不使用ScrollBar     更高级的ScrollViewer 更有用 </p>
<p>Slider和Progressbar 更实用</p>
<h4 id="6-6-1-Slider"><a href="#6-6-1-Slider" class="headerlink" title="6.6.1 Slider"></a>6.6.1 Slider</h4><p>Properties:</p>
<p>Orientation</p>
<p>Delay</p>
<p>Interval</p>
<p>TickPlacement</p>
<p>TickFrequency</p>
<p>Ticks</p>
<p>IsSnapToTickEnabled</p>
<p>IsSelectionRangeEnabled</p>
<h4 id="6-6-2-ProgressBar"><a href="#6-6-2-ProgressBar" class="headerlink" title="6.6.2 ProgressBar"></a>6.6.2 ProgressBar</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Margin</span>=<span class="string">"5"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ProgressBar</span> <span class="attr">Height</span>=<span class="string">"10"</span>  <span class="attr">IsIndeterminate</span>=<span class="string">"True"</span>&gt;</span><span class="tag">&lt;/<span class="name">ProgressBar</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="6-7-Date-Controls"><a href="#6-7-Date-Controls" class="headerlink" title="6.7  Date Controls"></a>6.7  Date Controls</h3><p>Calendar  and  DatePicker</p>
<p>properties</p>
<p>DisplayDateStart</p>
<p>DisplayDateEnd</p>
<p>BlackoutDates</p>
<p>SelectedDate</p>
<p>SelectedDates</p>
<p>DisplayDate</p>
<p>FirstDayOfWeek</p>
<p>IsTodayHighlighted</p>
<p>DisplayMode</p>
<p>SelectionMode</p>
<p>IsDropDownOpen</p>
<p>SelectedDateFormat</p>
<p>Event</p>
<p>SelectedDateChanged (DatePicker)  or  SelectedDatesChanged  in Calendar</p>
<h3 id="Text-Controls"><a href="#Text-Controls" class="headerlink" title="Text Controls"></a>Text Controls</h3><h3 id="List-Controls"><a href="#List-Controls" class="headerlink" title="List Controls"></a>List Controls</h3><h3 id="Range-Based-COntrols"><a href="#Range-Based-COntrols" class="headerlink" title="Range_Based COntrols"></a>Range_Based COntrols</h3><h3 id="Date-Controls"><a href="#Date-Controls" class="headerlink" title="Date Controls"></a>Date Controls</h3><h3 id="THe-last-world"><a href="#THe-last-world" class="headerlink" title="THe last world"></a>THe last world</h3><h2 id="Ch07-Application-Class"><a href="#Ch07-Application-Class" class="headerlink" title="Ch07 Application Class"></a>Ch07 Application Class</h2><h4 id="7-1-3-Application-Shutdown"><a href="#7-1-3-Application-Shutdown" class="headerlink" title="7.1.3 Application Shutdown"></a>7.1.3 Application Shutdown</h4><p>ShutdownMode Enumeration</p>
<p>OnLastWindowClose</p>
<p>OnMainWindowClose</p>
<p>OnExplicitShutdown</p>
<h4 id="7-2-1-显示初始界面"><a href="#7-2-1-显示初始界面" class="headerlink" title="7.2.1 显示初始界面"></a>7.2.1 显示初始界面</h4><p>上传图片修改为splashScreen</p>
<h4 id="7-2-2-处理命令行参数"><a href="#7-2-2-处理命令行参数" class="headerlink" title="7.2.2 处理命令行参数"></a>7.2.2 处理命令行参数</h4><p>命令行在 项目的 属性-调试里</p>
<h4 id="7-2-3-访问当前Application对象"><a href="#7-2-3-访问当前Application对象" class="headerlink" title="7.2.3 访问当前Application对象"></a>7.2.3 访问当前Application对象</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MainWindow main= (MainWindow)Application.Current.MainWindow;</span><br><span class="line">main.DoSomething();</span><br></pre></td></tr></table></figure>
<h4 id="7-2-4-在窗口之间进行交互"><a href="#7-2-4-在窗口之间进行交互" class="headerlink" title="7.2.4 在窗口之间进行交互"></a>7.2.4 在窗口之间进行交互</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public partial class App : Application</span><br><span class="line">   &#123;</span><br><span class="line">       private List&lt;Document&gt; documents = new List&lt;Document&gt;();</span><br><span class="line">       </span><br><span class="line">       public List&lt;Document&gt; Documents</span><br><span class="line">       &#123;</span><br><span class="line">           get &#123; return documents; &#125;</span><br><span class="line">           set &#123; documents = value; &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>添加到App class中 作为引用，类似 GameManager</p>
<h4 id="7-2-5-单实例应用程序"><a href="#7-2-5-单实例应用程序" class="headerlink" title="7.2.5 单实例应用程序"></a>7.2.5 单实例应用程序</h4><ol>
<li>创建单实例应用程序封装器。添加Microsoft.VisualBasic.dll程序集的引用，自定义类继承自Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase. </li>
<li>IsSingleInstance</li>
<li>~~OnStartup<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br></pre></td><td class="code"><pre><span class="line">4. OnStartupNextInstance()</span><br><span class="line"></span><br><span class="line">### 7.3 Assembly Resources</span><br><span class="line"></span><br><span class="line">#### 7.3.2 检索资源</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">StreamResourceInfo sri = Application.GetResourcesStream(</span><br><span class="line">	new Uri(&quot;images/winter.jpg&quot;,UriKind.Relative));</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">Assembly assembly = Assembly.GetAssembly(this.GetType());</span><br><span class="line">string resourceName= assembly.GetName().Name+&quot;.g&quot;;</span><br><span class="line">ResourceManager rm = new ResourceManager(resourceName,assembly);</span><br><span class="line">using(ResourceSet set = rm.GetResourceSet(CultureInfo.CurrentCulture,true,true))</span><br><span class="line">&#123;</span><br><span class="line">    UnmanagedMemoryStream s;</span><br><span class="line">    s =(UnmanagedMemoryStream)set.GetObject(&quot;images/winter.jpg&quot;,true);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用ResourceManager Class 和ResourceSet Class可以完成其他深层次功能。如下显示资源流中所有嵌入资源的名称。</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">Assembly assembly = Assembly.GetAssembly(this.GetType());</span><br><span class="line">string resourceName= assembly.GetName().Name+&quot;.g&quot;;</span><br><span class="line">ResourceManager rm = new ResourceManager(resourceName,assembly);</span><br><span class="line">using(ResourceSet set = rm.GetResourceSet(CultureInfo.CurrentCulture,true,true))</span><br><span class="line">&#123;</span><br><span class="line">    foreach(DictionaryEntry res in set)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(res.Key.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">能够理解资源的类</span><br><span class="line"></span><br><span class="line">`&lt;Image Source=&quot;Images/Blue hills.jpg&quot;/&gt;`</span><br><span class="line"></span><br><span class="line">代码 C# 完全限定的文件路径</span><br><span class="line"></span><br><span class="line">`img.Source= new BitmapImage(new Uri(@&quot;d:\Photo\Backgrounds\arch.jpg&quot;));`</span><br><span class="line"></span><br><span class="line">Relative path</span><br><span class="line"></span><br><span class="line">`img.Source = new BitmapImage(new Uri(&quot;images/winter.jpg&quot;,UriKind.Relative));`</span><br><span class="line"></span><br><span class="line">#### 7.3.3 pack URI</span><br><span class="line"></span><br><span class="line">images/winter.jpg</span><br><span class="line"></span><br><span class="line">pack://application:,,,/images/winter.jpg</span><br><span class="line"></span><br><span class="line">__位于其他程序集中的资源__</span><br><span class="line"></span><br><span class="line">pack://application:,,,/AssemblyName; component/ResourceName</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line">img.Source= new BItmapImage(</span><br><span class="line">new Uri(&quot;pack://application:,,,/ImageLibrary;component/images/winter.jpg&quot;));</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">ima.Source= new BitmapImage(</span><br><span class="line">new Uri(&quot;ImageLibrary; component/images/winter.jpg&quot;,UriKind.Relative));</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">版本号和公钥</span><br><span class="line"></span><br><span class="line">`new Uri(&quot;ImageLibrary;v1.25;dc642a7f5bd64912;component/images/winter.jpg&quot;,UriKind.Relative)`</span><br><span class="line"></span><br><span class="line">#### 7.3.4 Content Files</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line">&lt;MediaElement Name=&quot;Sound&quot; Source=&quot;Sounds/start.wav&quot; LoadedBehavior=&quot;Manual&quot;&gt;&lt;/MediaElement&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">### 7.4 Localization</span><br><span class="line"></span><br><span class="line">#### 7.4.2 为本地化做准备</span><br><span class="line"></span><br><span class="line">## Ch08  Element Binding</span><br><span class="line"></span><br><span class="line">### 8.1  Binding Elements Together</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 8.1.1 Binding Expressions</span><br><span class="line"></span><br><span class="line">绑定表达式只能用于设置依赖项属性。但是使用OneWayToSource模式可以克服，如果本身是依赖项属性</span><br><span class="line"></span><br><span class="line">&#123;&#125; 标记扩展</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line">&lt;TextBlock Margin=&quot;10&quot; Text=&quot;Simple Text&quot;  Name =&quot;lblSampleText&quot;</span><br><span class="line">           FontSize=&quot;&#123;Binding ElementName =sliderFontSize,Path=Value&#125;&quot;&gt;</span><br><span class="line">&lt;/TextBlock&gt;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">单向绑定  和双向绑定</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line">上例子</span><br><span class="line">FontSize = &quot;&#123;Binding ElementName = sliderFontSize,Path=Value,Mode=TwoWay&#125;&quot;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">BindingMode  Enum:</span><br><span class="line"></span><br><span class="line">OneWay</span><br><span class="line"></span><br><span class="line">TwoWay</span><br><span class="line"></span><br><span class="line">OneTime</span><br><span class="line"></span><br><span class="line">OneWayToSource</span><br><span class="line"></span><br><span class="line">Default</span><br><span class="line"></span><br><span class="line">#### 8.1.4 使用代码创建绑定</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">Binding binding = new Binding();</span><br><span class="line">binding.Source = sliderFontSize;</span><br><span class="line">binding.Path = new PropertyPath(&quot;Value&quot;);</span><br><span class="line">binding.Mode = BindingMode.TwoWay;</span><br><span class="line">lblSampleText.SetBinding(TextBlock.FontSize,binding);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">代码移除绑定 ClearBinding()   ClearAllBindings()</span><br><span class="line"></span><br><span class="line">#### 8.1.5 使用代码检索绑定</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">Binding binding = BindingOperations.GetBinding(lblSampleText,TextBlock.FontSize);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">BindingExpression expression = BindingOperations.GetBindingExpression(lblSampleText,TextBlock.FontSize);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 8.1.6多绑定</span><br><span class="line"></span><br><span class="line">#### 8.1.7 绑定更新</span><br><span class="line"></span><br><span class="line">UpdateSourceTrigger Enum:</span><br><span class="line"></span><br><span class="line">PropertyChanged</span><br><span class="line"></span><br><span class="line">LostFocus</span><br><span class="line"></span><br><span class="line">Explicit</span><br><span class="line"></span><br><span class="line">Default</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">BindingExpression binding = txtFontSize.GetBindingExpression(TextBox.TextProperty);</span><br><span class="line">binding.UpdateSource();</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 8.1.8  绑定延迟</span><br><span class="line"></span><br><span class="line">Delay 让输入时不要随时更新  watch 百度浏览器</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line">&lt;TextBox Text =&quot;&#123;Binding ElementName =txtSampleText,Path=FontSize,Mode=TwoWay,</span><br><span class="line">UpdateSourceTrigger =PropertyChanged,Delay=500&#125;&quot; Name=&quot;txtFontSize&quot;/&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 8.2 绑定到非元素对象</span><br><span class="line"></span><br><span class="line">需要放弃Binding.ElementName属性,并使用一下属性中的一个</span><br><span class="line"></span><br><span class="line">- Source:</span><br><span class="line">- RelativeSource:</span><br><span class="line">- DataContext:</span><br><span class="line"></span><br><span class="line">#### 8.2.1 Source属性</span><br><span class="line"></span><br><span class="line">最简单的选择</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;TextBlock Text=&quot;&#123;Binding Source=&#123;x:Static SystemFonts.IconFontFamily&#125;,Path=Source&#125;&quot;&gt;&lt;/TextBlock&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">alternative</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">    &lt;FontFamily x:Key=&quot;CustomFont&quot;&gt;Calibri&lt;/FontFamily&gt;</span><br><span class="line">&lt;/Window.Resources&gt;</span><br><span class="line">&lt;TextBlock Text=&quot;&#123;Binding Source=&#123;StaticResource CustomFont&#125;,Path=Source&#125;&quot;&gt;&lt;/TextBlock&gt;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 8.2.2 RelativeSource 属性</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;TextBlock&gt;</span><br><span class="line">    &lt;TextBlock.Text&gt;</span><br><span class="line">        &lt;Binding Path=&quot;Title&quot;&gt;</span><br><span class="line">            &lt;RelativeSource Mode=&quot;FindAncestor&quot; AncestorType=&quot;&#123;x:Type Window&#125;&quot;/&gt;</span><br><span class="line">        &lt;/Binding&gt;</span><br><span class="line">    &lt;/TextBlock.Text&gt;</span><br><span class="line">&lt;/TextBlock&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">合在一起</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;TextBlock Text=&quot;&#123;Binding Path=Title,RelativeSource=&#123;RelativeSource FindAncestor,AncestorType=&#123;x:Type Window&#125;&#125;&#125;&quot;&gt;&lt;/TextBlock&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FindAncestor四种模式</span><br><span class="line"></span><br><span class="line">Self</span><br><span class="line"></span><br><span class="line">FindAncestor</span><br><span class="line"></span><br><span class="line">PreviousData</span><br><span class="line"></span><br><span class="line">TemplateParent</span><br><span class="line"></span><br><span class="line">#### 8.2.3 DataContext属性</span><br><span class="line"></span><br><span class="line">大量元素绑定到同一个对象时使用</span><br><span class="line"></span><br><span class="line">使用FrameworkElement.DataContext属性 一次性定义绑定源会更清晰</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;StackPanel DataContext =&quot;&#123;x:Static SystemFonts.IconFontFamily&#125;&quot;&gt;&lt;/StackPanel&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;TextBlock Margin=&quot;5&quot; Text=&quot;&#123;Binding Path=Source&#125;&quot;&gt;&lt;/TextBlock&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Ch09  Commands</span><br><span class="line"></span><br><span class="line">WPF 新的命令模型</span><br><span class="line"></span><br><span class="line">- 将事件委托到适当的命令</span><br><span class="line">- 使控件的启用状态和相应命令的状态保持同步</span><br><span class="line"></span><br><span class="line">问题</span><br><span class="line"></span><br><span class="line">1. 命令跟踪</span><br><span class="line">2. 可撤销的命令</span><br><span class="line">3. 具有状态并且处于不同“模式”的命令</span><br><span class="line"></span><br><span class="line">### 9.2 WPF命令模型</span><br><span class="line"></span><br><span class="line">重要元素</span><br><span class="line"></span><br><span class="line">- 命令：</span><br><span class="line">- 命令绑定</span><br><span class="line">- 命令源</span><br><span class="line">- 命令目标</span><br><span class="line"></span><br><span class="line">#### 9.2.1 ICommand接口</span><br><span class="line"></span><br><span class="line">WPF命令模型的核心是System.Windows.Input.ICommand接口，定义了命令的工作原理</span><br><span class="line"></span><br><span class="line">包含两个方法和一个事件</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">public interface ICommand</span><br><span class="line">&#123;</span><br><span class="line">    void Execute(object parameter);</span><br><span class="line">    bool CanExecute(object parameter);</span><br><span class="line">    event EventHandler CanExecuteChanged;</span><br><span class="line">&#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 9.2.2 RoutedCommand Class</span><br><span class="line"></span><br><span class="line">using System.Windows.Input.RoutedCommand  Class</span><br><span class="line"></span><br><span class="line">所有WPF命令都是RoutedCommand类及其派生类的实例</span><br><span class="line"></span><br><span class="line">命令是WPF可插入体系架构的主要部分之一</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">public void Execute(object parameter,IInputElement target)</span><br><span class="line">&#123;...&#125;</span><br><span class="line">public bool CanExecute(object parameter,IInputElement target)</span><br><span class="line">&#123;...&#125;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">properties</span><br><span class="line"></span><br><span class="line">Name   OwnerType  something</span><br><span class="line"></span><br><span class="line">#### 9.2.3 RoutedUICommand  class</span><br><span class="line"></span><br><span class="line">#### 9.2.4 命令库</span><br><span class="line"></span><br><span class="line">常用的命令由以下5个专门的静态类的静态属性提供</span><br><span class="line"></span><br><span class="line">- ApplicationCommands</span><br><span class="line">- NavigationCommands</span><br><span class="line">- EditingCommands</span><br><span class="line">- ComponentCommands</span><br><span class="line">- MediaCommands</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 9.3 Excute Command</span><br><span class="line"></span><br><span class="line">#### 9.3.1 命令源</span><br><span class="line"></span><br><span class="line">触发命令库的命令始终可用。 触发他们最简单的方法是关联到实现了ICommandSource接口的控件，包括ButtonBase类的控件，ListBoxItem   Hyperlink  MenuItem</span><br><span class="line"></span><br><span class="line">ICommandSource 接口定义了三个属性</span><br><span class="line"></span><br><span class="line">Command </span><br><span class="line"></span><br><span class="line">CommandParameter</span><br><span class="line"></span><br><span class="line">CommandTarget</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Command=&quot;ApplicationCommands.New&quot;&gt;New&lt;/Button&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Command=&quot;New&quot;&gt;New&lt;/Button&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 9.3.2 命令绑定</span><br><span class="line"></span><br><span class="line">仅仅用上面是不够的，被禁用，所以要明确以下三件事情：</span><br><span class="line"></span><br><span class="line">- 当命令被触发时执行什么操作</span><br><span class="line">- 如何确定命令是否被执行</span><br><span class="line">- 命令在何处起作用</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">//Creat the binding.</span><br><span class="line">CommandBinding binding = new CommandBinding(ApplicationCommands.New);</span><br><span class="line">//Attach the event handler.</span><br><span class="line">binding.Executed+= NewCommand_Executed;</span><br><span class="line">//Register the binding</span><br><span class="line">this.CommandBindings.Add(binding);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">当单击按钮时，CommandBinding.Executed事件从按钮冒泡到包含元素。</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window x:Class=&quot;Commands.herTestWindow&quot;</span><br><span class="line">        xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span><br><span class="line">        xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span><br><span class="line">        Title=&quot;herTestWindow&quot; Height=&quot;450&quot; Width=&quot;200&quot;&gt;</span><br><span class="line">    &lt;Window.CommandBindings&gt;</span><br><span class="line">        &lt;CommandBinding Command=&quot;ApplicationCommands.New&quot;</span><br><span class="line">                        Executed=&quot;CommandBinding_Executed&quot;&gt;&lt;/CommandBinding&gt;</span><br><span class="line">    &lt;/Window.CommandBindings&gt;</span><br><span class="line"></span><br><span class="line">    &lt;StackPanel Margin=&quot;5&quot;&gt;</span><br><span class="line">        &lt;Button Padding=&quot;5&quot; Command=&quot;ApplicationCommands.New&quot;&gt;New&lt;/Button&gt;</span><br><span class="line">    &lt;/StackPanel&gt;</span><br><span class="line">&lt;/Window&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 9.3.3 使用多命令源</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Menu&gt;</span><br><span class="line">    &lt;MenuItem Header=&quot;File&quot;&gt;</span><br><span class="line">        &lt;MenuItem Command=&quot;New&quot;&gt;&lt;/MenuItem&gt;</span><br><span class="line">    &lt;/MenuItem&gt;</span><br><span class="line">&lt;/Menu&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 9.3.4 微调命令文本</span><br><span class="line"></span><br><span class="line">xaml通过Static 标记扩展完成直接从静态命令对象中提取文本。</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Command=&quot;New&quot; Content=&quot;&#123;x:Static ApplicationCommands.New&#125;&quot;&gt;&lt;/Button&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Margin=&quot;5&quot; Padding=&quot;5&quot; Command =&quot;ApplicationCommands.New&quot; Content =&quot;&#123;Binding RelativeSource=&#123;RelativeSource Self&#125;,Path=Command.Text&#125;&quot;</span><br><span class="line">        &gt;&lt;/Button&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Margin=&quot;5&quot; Padding=&quot;5&quot; Command =&quot;ApplicationCommands.New&quot; ToolTip=&quot;&#123;Binding RelativeSource=&#123;RelativeSource&#125;=&#123;RelativeSource Self&#125;,Path =Command.Text&#125;&quot;&gt;</span><br><span class="line">	&lt;Image.../&gt;</span><br><span class="line">&lt;/Button&gt;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 9.3.5 直接调用命令</span><br><span class="line"></span><br><span class="line">`ApplicationCommands.New.Execute(null,targetElement);`</span><br><span class="line"></span><br><span class="line">#### 9.3.6 禁用命令</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">CommandBinding binding = new CommandBinding(ApplicationCommands.Save);</span><br><span class="line">binding.Executed +=SaveCommand_Executed;</span><br><span class="line">binding.CanExecute +=SaveCommand_CanExecute;</span><br><span class="line">this.CommandBindings.Add(binding);</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.CommandBindings&gt;</span><br><span class="line">	&lt;CommandBinding Command =&quot;ApplicationCommands.Save&quot;</span><br><span class="line">                    Executed=&quot;SaveCommand_Executed&quot; CanExecute =&quot;SaveCommand_CanExecute&quot;&gt;</span><br><span class="line">    &lt;/CommandBinding&gt;</span><br><span class="line">&lt;/Window.CommandBindings&gt;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 9.3.7 具有内置命令的控件</span><br><span class="line"></span><br><span class="line">对于简单文本编辑器 添加工具栏按钮，自动获得支持</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;ToolBar&gt;</span><br><span class="line">	&lt;Button Command=&quot;Cut&quot;&gt;Cut&lt;/Button&gt;</span><br><span class="line">    &lt;Button Command=&quot;Copy&quot;&gt;Copy&lt;/Button&gt;</span><br><span class="line">    &lt;Button COmmand=&quot;Paste&quot;&gt;Paste&lt;/Button&gt;</span><br><span class="line">&lt;/ToolBar&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">在非ToolBar  或者Menu中使用时，就不会获得这项优势</span><br><span class="line"></span><br><span class="line">绑定表达式</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Command=&quot;Cut&quot; CommandTarget=&quot;&#123;Binding ElementName = txtDocument&#125;&quot;&gt;Cut&lt;/Button&gt;</span><br><span class="line">&lt;Button Command=&quot;Copy&quot; CommandTarget=&quot;&#123;Binding ElementName = txtDocument&#125;&quot;&gt;Cut&lt;/Button&gt;</span><br><span class="line">&lt;Button Command=&quot;Paste&quot; CommandTarget=&quot;&#123;Binding ElementName = txtDocument&#125;&quot;&gt;Cut&lt;/Button&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">新的焦点范围 FocusManager.IsFocusScope</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;StackPanel FocusManager.IsFocusScope=&quot;True&quot;&gt;</span><br><span class="line">	&lt;Button Command=&quot;Cut&quot;&gt;Cut&lt;/Button&gt;</span><br><span class="line">    &lt;Button Command=&quot;Copy&quot;&gt;Copy&lt;/Button&gt;</span><br><span class="line">    &lt;Button COmmand=&quot;Paste&quot;&gt;Paste&lt;/Button&gt;</span><br><span class="line">&lt;/StackPanel&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">删除命令。。。</span><br><span class="line"></span><br><span class="line">### 9.4 高级命令</span><br><span class="line"></span><br><span class="line">#### 9.4.1 自定义命令</span><br><span class="line"></span><br><span class="line">实例化一个新的RoutedUICommand对象</span><br><span class="line"></span><br><span class="line">范式</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">public class DataCommands</span><br><span class="line">        &#123;</span><br><span class="line">            private static RoutedUICommand requery;</span><br><span class="line">            static DataCommands()</span><br><span class="line">            &#123;</span><br><span class="line">                InputGestureCollection inputs = new InputGestureCollection();</span><br><span class="line">                inputs.Add(new KeyGesture(Key.R, ModifierKeys.Control, &quot;Ctrl+R&quot;));</span><br><span class="line">                requery = new RoutedUICommand(</span><br><span class="line">                    &quot;Requery&quot;, &quot;Requery&quot;, typeof(DataCommands), inputs);</span><br><span class="line">            &#125;</span><br><span class="line">            public static RoutedUICommand Requery</span><br><span class="line">            &#123; get &#123; return requery; &#125; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 9.4.2  未完成</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Ch10 资源</span><br><span class="line"></span><br><span class="line">对象资源</span><br><span class="line"></span><br><span class="line">### 10.1 资源基础</span><br><span class="line"></span><br><span class="line">资源优点</span><br><span class="line"></span><br><span class="line">- 高效</span><br><span class="line">- 可维护性</span><br><span class="line">- 适应性</span><br><span class="line"></span><br><span class="line">通常在窗口级别定义资源</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">	&lt;ImageBrush x:Key=&quot;TeileBrush&quot; TileMode=&quot;Tile&quot; ViewportUnits=&quot;Absolute&quot; Viewport=&quot;0 0 32 32&quot; ImageSource=&quot;happyface.jpg&quot; Opacity=&quot;0.3&quot;/&gt;</span><br><span class="line">&lt;/Window.Resources&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 代码访问资源</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">private void cmdChange_Click(object sender,RoutedEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Button cmd = (Button)sender;</span><br><span class="line">            ImageBrush brush = (ImageBrush)sender.FindResource(&quot;TileBrush&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 10.1.6 应用程序资源</span><br><span class="line"></span><br><span class="line">如果对象需要被广泛重用，可使用应用程序资源；如果只是在两三个窗口中调用，可以考虑在每个窗口定义。</span><br><span class="line"></span><br><span class="line">#### 10.1.7 系统资源</span><br><span class="line"></span><br><span class="line">Class： SystemColors   SystemFonts  SystemParameters</span><br><span class="line"></span><br><span class="line">都位于System.Windows名称空间中  另外System.Drawing中有个易混淆的</span><br><span class="line"></span><br><span class="line">### 10.2 资源字典</span><br><span class="line"></span><br><span class="line">资源字典的Build Action 设置为Page，这样可以最佳性能 编译为BAML ，设置Resource也是可以的，嵌入程序集，但是解析它的速度要慢一点。</span><br><span class="line"></span><br><span class="line">不允许合并使用相同资源名称的资源字典</span><br><span class="line"></span><br><span class="line">#### 10.2.3 在程序集之间共享资源</span><br><span class="line"></span><br><span class="line">常用方式 将资源字典放置到generic.xaml文件中，并且必须将该文件放到应用程序文件夹的Themes子文件夹中</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">in generic.xaml</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">ImageBrush</span><br><span class="line">      x:Key=&quot;&#123;ComponentResourceKey TypeInTargetAssembly=&#123;x:Type local:CustomResources&#125;, ResourceId=SadTileBrush&#125;&quot;</span><br><span class="line">      TileMode=&quot;Tile&quot;</span><br><span class="line">      ViewportUnits=&quot;Absolute&quot; Viewport=&quot;0 0 32 32&quot;</span><br><span class="line">      ImageSource=&quot;ResourceLibrary;component/sadface.jpg&quot; Opacity=&quot;0.3&quot;&gt;</span><br><span class="line">    &lt;/ImageBrush&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">in CustomResources.cs</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">namespace ResourceLibrary</span><br><span class="line">&#123;</span><br><span class="line">    public class CustomResources</span><br><span class="line">    &#123;</span><br><span class="line">        public static ComponentResourceKey SadTileBrush</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                return new ComponentResourceKey(</span><br><span class="line">                    typeof(CustomResources), &quot;SadTileBrush&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">引用方式</span><br><span class="line"></span><br><span class="line">xmlns:res=&quot;clr-namespace:ResourceLibrary;assembly=ResourceLibrary&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Button Background=&quot;&#123;DynamicResource &#123;ComponentResourceKey TypeInTargetAssembly=&#123;x:Type res:CustomResources&#125;, ResourceId=SadTileBrush&#125;&#125;&quot;</span><br><span class="line">            Padding=&quot;5&quot; Margin=&quot;5&quot;</span><br><span class="line">            FontWeight=&quot;Bold&quot; FontSize=&quot;14&quot;&gt;</span><br><span class="line">      A Resource From ResourceLibrary&lt;/Button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Button Background=&quot;&#123;DynamicResource &#123;x:Static res:CustomResources.SadTileBrush&#125;&#125;&quot;</span><br><span class="line">        Padding=&quot;5&quot; Margin=&quot;5&quot;</span><br><span class="line">        FontWeight=&quot;Bold&quot; FontSize=&quot;14&quot;&gt;</span><br><span class="line">      A Resource From ResourceLibrary</span><br><span class="line">    &lt;/Button&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">## Ch11 样式和行为</span><br><span class="line"></span><br><span class="line">### 11.1 样式基础</span><br><span class="line"></span><br><span class="line">Style Properties:</span><br><span class="line"></span><br><span class="line">Setters</span><br><span class="line"></span><br><span class="line">Triggers</span><br><span class="line"></span><br><span class="line">Resources</span><br><span class="line"></span><br><span class="line">BasedOn</span><br><span class="line"></span><br><span class="line">TargetType</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">        &lt;Style x:Key=&quot;BigFontButtonStyle&quot;&gt;</span><br><span class="line">            &lt;Setter Property=&quot;Control.FontFamily&quot; Value=&quot;Times New Roman&quot;/&gt;</span><br><span class="line">            &lt;Setter Property=&quot;Control.FontSize&quot; Value=&quot;18&quot;/&gt;</span><br><span class="line">            &lt;Setter Property=&quot;Control.FontWeight&quot; Value=&quot;Bold&quot;/&gt;</span><br><span class="line">        &lt;/Style&gt;</span><br><span class="line">    &lt;/Window.Resources&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 11.1.1 创建样式对象</span><br><span class="line"></span><br><span class="line">#### 11.1.2 设置属性</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">如果创建只应用与按钮的样式</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Style x:Key=&quot;ButtonStyle1&quot; TargetType=&quot;Button&quot;&gt;</span><br><span class="line">            &lt;Setter Property=&quot;FontFamily&quot; Value=&quot;Times New Roman&quot;/&gt;</span><br><span class="line">            &lt;Setter Property=&quot;FontSize&quot; Value=&quot;18&quot;/&gt;</span><br><span class="line">            &lt;Setter Property=&quot;Foreground&quot; Value=&quot;AliceBlue&quot;/&gt;</span><br><span class="line">        &lt;/Style&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">#### 11.1.3 关联事件处理程序</span><br><span class="line"></span><br><span class="line">Button.Click win套路</span><br><span class="line"></span><br><span class="line">```c#</span><br><span class="line">private void ButtonClick(object sender, RoutedEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Button cmd = (Button)e.OriginalSource;</span><br><span class="line">            Type type = this.GetType();</span><br><span class="line">            Assembly ass = type.Assembly;</span><br><span class="line">            Window win = (Window)ass.CreateInstance(type.Namespace + &quot;.&quot; + cmd.Content);</span><br><span class="line">            win.ShowDialog();</span><br><span class="line">        &#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 11.1.4 多层样式</span><br><span class="line"></span><br><span class="line">样式的继承</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">    &lt;Style x:Key=&quot;BigFontButtonStyle&quot;&gt;</span><br><span class="line">      &lt;Setter Property=&quot;Control.FontFamily&quot; Value=&quot;Times New Roman&quot; /&gt;</span><br><span class="line">      &lt;Setter Property=&quot;Control.FontSize&quot; Value=&quot;18&quot; /&gt;</span><br><span class="line">      &lt;Setter Property=&quot;Control.FontWeight&quot; Value=&quot;Bold&quot; /&gt;</span><br><span class="line">    &lt;/Style&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Style x:Key=&quot;EmphasizedBigFontButtonStyle&quot; BasedOn=&quot;&#123;StaticResource BigFontButtonStyle&#125;&quot;&gt;</span><br><span class="line">      &lt;Setter Property=&quot;Control.Foreground&quot; Value=&quot;White&quot; /&gt;</span><br><span class="line">      &lt;Setter Property=&quot;Control.Background&quot; Value=&quot;DarkBlue&quot; /&gt;</span><br><span class="line">    &lt;/Style&gt;</span><br><span class="line">  &lt;/Window.Resources&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">但是轻易不要使用样式继承</span><br><span class="line"></span><br><span class="line">#### 11.1.5 通过类型自动应用样式</span><br><span class="line"></span><br><span class="line">`x:Key =&quot;&#123;x:Type Button&#125;&quot;`</span><br><span class="line"></span><br><span class="line">### 11.2 Trigger</span><br><span class="line"></span><br><span class="line">继承自 System.Windows.TriggerBase的派生类的实例</span><br><span class="line"></span><br><span class="line">Trigger</span><br><span class="line"></span><br><span class="line">MultiTrigger</span><br><span class="line"></span><br><span class="line">DataTrigger</span><br><span class="line"></span><br><span class="line">MultiDataTrigger</span><br><span class="line"></span><br><span class="line">EventTrigger</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">        &lt;Style x:Key=&quot;BigFontButton&quot;&gt;</span><br><span class="line">            &lt;Style.Setters&gt;</span><br><span class="line">                &lt;Setter Property=&quot;Control.FontFamily&quot; Value=&quot;Times New Roman&quot;/&gt;</span><br><span class="line">                &lt;Setter Property=&quot;Control.FontSize&quot; Value=&quot;18&quot;/&gt;</span><br><span class="line">            &lt;/Style.Setters&gt;</span><br><span class="line">            &lt;Style.Triggers&gt;</span><br><span class="line">                &lt;Trigger Property=&quot;Control.IsFocused&quot; Value=&quot;True&quot;&gt;</span><br><span class="line">                    &lt;Setter Property=&quot;Control.Foreground&quot;  Value=&quot;DarkRed&quot;&gt;&lt;/Setter&gt;</span><br><span class="line">                &lt;/Trigger&gt;</span><br><span class="line">            &lt;/Style.Triggers&gt;</span><br><span class="line">        &lt;/Style&gt;</span><br><span class="line">    &lt;/Window.Resources&gt;</span><br><span class="line">    &lt;StackPanel&gt;</span><br><span class="line">        &lt;Button Style=&quot;&#123;StaticResource BigFontButton&#125;&quot;&gt;jkjljko&lt;/Button&gt;</span><br><span class="line">        &lt;Button Style=&quot;&#123;StaticResource BigFontButton&#125;&quot;&gt;jkjljko&lt;/Button&gt;</span><br><span class="line">    &lt;/StackPanel&gt;</span><br><span class="line"></span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MultiTrigger  提供Conditions集合</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 11.2.2 事件触发器</span><br><span class="line"></span><br><span class="line">简单的动画</span><br><span class="line"></span><br><span class="line">使用预先构建的DoubleAnimation Class  位于System.Windows.Media.Animation名称空间。</span><br><span class="line"></span><br><span class="line">```xaml</span><br><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">    &lt;Style x:Key=&quot;BigFontButton&quot;&gt;</span><br><span class="line">      &lt;Style.Setters&gt;</span><br><span class="line">        &lt;Setter Property=&quot;Control.FontFamily&quot; Value=&quot;Times New Roman&quot; /&gt;</span><br><span class="line">        &lt;Setter Property=&quot;Control.FontSize&quot; Value=&quot;18&quot; /&gt;</span><br><span class="line">        &lt;Setter Property=&quot;Control.FontWeight&quot; Value=&quot;Bold&quot; /&gt;</span><br><span class="line">      &lt;/Style.Setters&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;Style.Triggers&gt;</span><br><span class="line">        &lt;EventTrigger RoutedEvent=&quot;Mouse.MouseEnter&quot;&gt;</span><br><span class="line">          &lt;EventTrigger.Actions&gt;</span><br><span class="line">            &lt;BeginStoryboard&gt;</span><br><span class="line">              &lt;Storyboard&gt;</span><br><span class="line">                &lt;DoubleAnimation</span><br><span class="line">                  Duration=&quot;0:0:0.2&quot;</span><br><span class="line">                  Storyboard.TargetProperty=&quot;FontSize&quot;</span><br><span class="line">                  To=&quot;22&quot;  /&gt;</span><br><span class="line">              &lt;/Storyboard&gt;</span><br><span class="line">            &lt;/BeginStoryboard&gt;</span><br><span class="line">          &lt;/EventTrigger.Actions&gt;</span><br><span class="line">        &lt;/EventTrigger&gt;</span><br><span class="line">        &lt;EventTrigger RoutedEvent=&quot;Mouse.MouseLeave&quot;&gt;</span><br><span class="line">          &lt;EventTrigger.Actions&gt;</span><br><span class="line">            &lt;BeginStoryboard&gt;</span><br><span class="line">              &lt;Storyboard&gt;</span><br><span class="line">                &lt;DoubleAnimation</span><br><span class="line">                  Duration=&quot;0:0:1&quot;</span><br><span class="line">                  Storyboard.TargetProperty=&quot;FontSize&quot;  /&gt;</span><br><span class="line">              &lt;/Storyboard&gt;</span><br><span class="line">            &lt;/BeginStoryboard&gt;</span><br><span class="line">          &lt;/EventTrigger.Actions&gt;</span><br><span class="line">        &lt;/EventTrigger&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/Style.Triggers&gt;</span><br><span class="line">    &lt;/Style&gt;</span><br><span class="line">    </span><br><span class="line">  &lt;/Window.Resources&gt;</span><br><span class="line"></span><br><span class="line">  &lt;StackPanel Margin=&quot;5&quot;&gt;</span><br><span class="line">    &lt;Button Padding=&quot;5&quot; Margin=&quot;5&quot;</span><br><span class="line">            Style=&quot;&#123;StaticResource BigFontButton&#125;&quot; </span><br><span class="line">              &gt;A Customized Button&lt;/Button&gt;</span><br><span class="line">    &lt;TextBlock Margin=&quot;5&quot;&gt;Normal Content.&lt;/TextBlock&gt;</span><br><span class="line">    &lt;Button Padding=&quot;5&quot; Margin=&quot;5&quot;</span><br><span class="line">            &gt;A Normal Button&lt;/Button&gt;</span><br><span class="line">    &lt;TextBlock Margin=&quot;5&quot;&gt;More normal Content.&lt;/TextBlock&gt;</span><br><span class="line">    &lt;Button Padding=&quot;5&quot; Margin=&quot;5&quot;</span><br><span class="line">            Style=&quot;&#123;StaticResource BigFontButton&#125;&quot; </span><br><span class="line">              &gt;Another Customized Button&lt;/Button&gt;</span><br><span class="line">  &lt;/StackPanel&gt;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">依赖项属性等于某个特定值时也可以执行动画。~~~~~~~~</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Ch12-理解形状"><a href="#Ch12-理解形状" class="headerlink" title="Ch12 理解形状"></a>Ch12 理解形状</h2><p>形状是元素</p>
<ul>
<li>形状绘制自身</li>
<li>使用与其他元素相同的方式组织形状</li>
<li>形状支持与其他元素相同的事件</li>
</ul>
<h4 id="12-1-1-Shape-Class"><a href="#12-1-1-Shape-Class" class="headerlink" title="12.1.1 Shape Class"></a>12.1.1 Shape Class</h4><p>形状都继承自 System.Window.Shapes.Shape</p>
<p>DispatcherObject-&gt;DependencyObject-&gt;Visual -&gt; UIElement -&gt; FrameworkElement-&gt;Shape:</p>
<p>{Rectangle Ellipse Line Polyline Polygon Path}</p>
<p>Properties:</p>
<p>{Fill  Stroke StrokeThickness StrokeStartLineCap StrokeEndLineCap StrokeDashArray StokeDashOffset StrokeDashCap StrokeLineJoin StorkeMiterLimit  Stretch DefiningGeometry GeometryTransform  RenderedGeometry}</p>
<h4 id="12-1-2-矩形和椭圆"><a href="#12-1-2-矩形和椭圆" class="headerlink" title="12.1.2 矩形和椭圆"></a>12.1.2 矩形和椭圆</h4><p>如果未设置Stroke 或者Fill属性，形状根本就不会显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;StackPanel&gt;</span><br><span class="line">	&lt;Ellipse Fill=&quot;Yellow&quot; Stroke=&quot;Blue&quot; Height=&quot;50&quot; Width=&quot;100&quot; Margin=&quot;5&quot; </span><br><span class="line">             HorizontalAlignment=&quot;Left&quot;&gt;&lt;/Ellipse&gt;</span><br><span class="line">    &lt;Rectangle Fill=&quot;Yellow&quot; Stroke=&quot;Blue&quot; Height=&quot;50&quot; Width=&quot;100&quot; Margin=&quot;5&quot;</span><br><span class="line">               HorizontalAlignment=&quot;Left&quot;&gt;&lt;/Rectangle&gt;</span><br><span class="line">&lt;/StackPanel&gt;</span><br></pre></td></tr></table></figure>
<h4 id="12-1-5-直线"><a href="#12-1-5-直线" class="headerlink" title="12.1.5 直线"></a>12.1.5 直线</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Line Stroke=&quot;Blue&quot; X1=&quot;0&quot; Y1=&quot;0&quot; X2=&quot;10&quot; Y2=&quot;100&quot;&gt;&lt;/Line&gt;</span><br></pre></td></tr></table></figure>
<h4 id="12-1-6-amp-7-折线和多边形"><a href="#12-1-6-amp-7-折线和多边形" class="headerlink" title="12.1.6&amp;7  折线和多边形"></a>12.1.6&amp;7  折线和多边形</h4><p>FillRule</p>
<p>:EvenOdd</p>
<h4 id="12-1-8-直线线帽和直线交点"><a href="#12-1-8-直线线帽和直线交点" class="headerlink" title="12.1.8 直线线帽和直线交点"></a>12.1.8 直线线帽和直线交点</h4><p>Properties   StartLineCap EndLineCap</p>
<h4 id="12-1-9-点划线"><a href="#12-1-9-点划线" class="headerlink" title="12.1.9 点划线"></a>12.1.9 点划线</h4><h4 id="12-1-10-像素对齐"><a href="#12-1-10-像素对齐" class="headerlink" title="12.1.10 像素对齐"></a>12.1.10 像素对齐</h4><p>通过设置UIElement 类的SnapsToDevicePixels属性为True来启动这个称为像素对齐的特性</p>
<h3 id="12-2-画刷"><a href="#12-2-画刷" class="headerlink" title="12.2 画刷"></a>12.2 画刷</h3><p>Classes</p>
<p>SolidColorBrush</p>
<p>LinearGradientBrush</p>
<p>RadialGradientBrush</p>
<p>ImageBrush</p>
<p>DrawingBrush</p>
<p>VisualBrush</p>
<p>BitmapCacheBrush</p>
<p>可以在使用SolidColorBrush画刷的任何时候替代LinearGradientBrush</p>
<p>平铺模式的 TileMode 枚举类型的Tile值</p>
<h3 id="12-3-变换"><a href="#12-3-变换" class="headerlink" title="12.3 变换"></a>12.3 变换</h3><p>变换 继承自System.Windows.Media.Transform抽象类的类表示</p>
<p>TranslateTransform</p>
<p>RotateTransform</p>
<p>ScaleTransform</p>
<p>SkewTransform</p>
<p>MatrixTransform</p>
<p>TransformGroup</p>
<p>例如</p>
<p>倾斜形状</p>
<p>重复形状</p>
<p>动画</p>
<h3 id="12-4-透明"><a href="#12-4-透明" class="headerlink" title="12.4 透明"></a>12.4 透明</h3><h4 id="12-4-2-透明掩码"><a href="#12-4-2-透明掩码" class="headerlink" title="12.4.2 透明掩码"></a>12.4.2 透明掩码</h4><h3 id="12-5-小结"><a href="#12-5-小结" class="headerlink" title="12.5 小结"></a>12.5 小结</h3><p>详细分析了WPF对基本二维绘图的支持。首先学习了简单的形状类；然后学习 了如何使用简单和复杂的画刷绘制形状的边框以及填充形状，如何使用变换移动/旋转以及扭曲形状，最后简要介绍 了透明效果。</p>
<h2 id="Ch13-几何图形和图画"><a href="#Ch13-几何图形和图画" class="headerlink" title="Ch13 几何图形和图画"></a>Ch13 几何图形和图画</h2><h3 id="13-1-路径和几何图形"><a href="#13-1-路径和几何图形" class="headerlink" title="13.1 路径和几何图形"></a>13.1 路径和几何图形</h3><p>抽象类Geometry 有7个派生类</p>
<p>LineGeometry</p>
<p>RectangleGeometry</p>
<p>EllipseGeometry</p>
<p>GeometryGroup</p>
<p>CombinedGeometry</p>
<p>PathGeometry</p>
<p>StreamGeometry</p>
<h4 id="13-1-1-直线-矩形和椭圆图形"><a href="#13-1-1-直线-矩形和椭圆图形" class="headerlink" title="13.1.1 直线 矩形和椭圆图形"></a>13.1.1 直线 矩形和椭圆图形</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Path Fill=&quot;Yellow&quot; Stroke=&quot;Blue&quot;&gt;</span><br><span class="line">	&lt;Path.Data&gt;</span><br><span class="line">    	&lt;RectangleGeometry Rect=&quot;0,0 100,50&quot;&gt;&lt;/RectangleGeometry&gt;</span><br><span class="line">    &lt;/Path.Data&gt;</span><br><span class="line">&lt;/Path&gt;</span><br></pre></td></tr></table></figure>
<p>…</p>
<p>没仔细看</p>
<h3 id="13-3-小结"><a href="#13-3-小结" class="headerlink" title="13.3 小结"></a>13.3 小结</h3><p>深入分析了WPF应用程序的2D绘图模型。首先全面介绍了功能最强大的WPF形状类Path。接下来分析了如何使用几何图形构建图画，以及如何使用图画显示无交互功能的轻量级图形。</p>
<h2 id="Ch14-效果和可视化对象"><a href="#Ch14-效果和可视化对象" class="headerlink" title="Ch14  效果和可视化对象"></a>Ch14  效果和可视化对象</h2><p>访问低级图形功能，三种WPF技术</p>
<ul>
<li>可视化对象(Visual)</li>
<li>效果(Effect)</li>
<li>WriteableBitmap 类</li>
</ul>
<h4 id="14-1-1-绘制可视化对象"><a href="#14-1-1-绘制可视化对象" class="headerlink" title="14.1.1 绘制可视化对象"></a>14.1.1 绘制可视化对象</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DrawingVisual visual = new DrawingVisual();</span><br><span class="line">DrawingContext dc = visual.RenderOpen();</span><br><span class="line">//画画</span><br><span class="line">dc.Close();</span><br></pre></td></tr></table></figure>
<p>DrawingContext  class  methods:</p>
<p>DrawLine()</p>
<p>DrawRectangle()</p>
<p>DrawRoundedRectangle()</p>
<p>DrawEllipse()</p>
<p>DrawGeometry()</p>
<p>DrawDrawing()</p>
<p>DrawText()</p>
<p>DrawImage()</p>
<p>DrawVideo()</p>
<p>Pop()</p>
<p>PushClip()</p>
<p>PushEffect()</p>
<p>PushOpacity()</p>
<p>PushOpacityMask()</p>
<p>PushTransform()</p>
<p><strong>掠过</strong></p>
<h2 id="Ch15-Animate"><a href="#Ch15-Animate" class="headerlink" title="Ch15 Animate"></a>Ch15 Animate</h2><h3 id="15-1-理解WPF动画"><a href="#15-1-理解WPF动画" class="headerlink" title="15.1 理解WPF动画"></a>15.1 理解WPF动画</h3><h4 id="15-1-1-基于时间的动画"><a href="#15-1-1-基于时间的动画" class="headerlink" title="15.1.1 基于时间的动画"></a>15.1.1 基于时间的动画</h4><h4 id="15-1-2-基于属性的动画"><a href="#15-1-2-基于属性的动画" class="headerlink" title="15.1.2 基于属性的动画"></a>15.1.2 基于属性的动画</h4><p>​    此为为普通的Windows应用程序添加动态效果的极佳方式</p>
<h3 id="15-2-基本动画"><a href="#15-2-基本动画" class="headerlink" title="15.2 基本动画"></a>15.2 基本动画</h3><p>​    WPF使用动画要有相应的动画类</p>
<h4 id="15-2-1-Animation-Class"><a href="#15-2-1-Animation-Class" class="headerlink" title="15.2.1 Animation Class"></a>15.2.1 Animation Class</h4><p>​    插值动画 和关键帧动画</p>
<p>插值一般命名为DoubleAnimation  xxxAnimation   关键帧 是类型名+AnimationUsingKeyFrames 如StringAnimationUsingKeyFrames  ObjectAnimationUsingKeyFrames</p>
<p>由于有object</p>
<p>所以所有具有常规动画类的 都支持相应的关键帧动画类</p>
<p>路径动画 DoubleAnimationUsingPath  PointAnimationUsingPath</p>
<h4 id="15-2-2-使用代码创建动画"><a href="#15-2-2-使用代码创建动画" class="headerlink" title="15.2.2 使用代码创建动画"></a>15.2.2 使用代码创建动画</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DoubleAnimation widthAnimation = new DoubleAnimation();</span><br><span class="line">            widthAnimation.From = 160;</span><br><span class="line">            widthAnimation.To = this.Width - 30;</span><br><span class="line">            widthAnimation.Duration = TimeSpan.FromSeconds(2);</span><br><span class="line">            button.BeginAnimation(Button.WidthProperty, widthAnimation);</span><br></pre></td></tr></table></figure>
<p>From属性对于不清楚宽度的情况时候:<code>widthAnimation.From = cmdGrow.ActualWidth;</code></p>
<p>不使用To属性时，也可以使用By属性。：<code>widthAnimation.By=10;</code></p>
<p>IsAdditive属性创建增加数值的动画</p>
<p>Duration.Automatic  Duration.Forever.</p>
<h4 id="15-2-3-同时发生的动画"><a href="#15-2-3-同时发生的动画" class="headerlink" title="15.2.3 同时发生的动画"></a>15.2.3 同时发生的动画</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">private void cmdGrow_Click(object sender, RoutedEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            DoubleAnimation widthAnimation = new DoubleAnimation();</span><br><span class="line">            widthAnimation.To = this.Width - 30;</span><br><span class="line">            widthAnimation.Duration = TimeSpan.FromSeconds(5);</span><br><span class="line">            widthAnimation.Completed += animation_Completed;</span><br><span class="line"></span><br><span class="line">            DoubleAnimation heightAnimation = new DoubleAnimation();</span><br><span class="line">            heightAnimation.To = (this.Height - 50)/3;</span><br><span class="line">            heightAnimation.Duration = TimeSpan.FromSeconds(5);</span><br><span class="line"></span><br><span class="line">            cmdGrow.BeginAnimation(Button.WidthProperty, widthAnimation);</span><br><span class="line">            cmdGrow.BeginAnimation(Button.HeightProperty, heightAnimation);    </span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>这两个动画不会同时发生。通常先宽 后高</p>
<h4 id="15-2-4-动画的生命-周期"><a href="#15-2-4-动画的生命-周期" class="headerlink" title="15.2.4 动画的生命 周期"></a>15.2.4 动画的生命 周期</h4><p>​    WPF动画并不能真正改变属性的值，只是活动时覆盖。单向动画在运行结束后依然活动，此时改属性值将不起作用。</p>
<p>​    解决方式</p>
<ul>
<li>动画设置解决</li>
<li>当动画完成时处理Completed事件删除动画对象</li>
</ul>
<p>如上的<code>widthAnimation.Completed += animation_Completed;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private void animation_Completed(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            double currentWidth = cmdGrow.Width;</span><br><span class="line">            cmdGrow.BeginAnimation(Button.WidthProperty, null);</span><br><span class="line">            cmdGrow.Width = currentWidth;</span><br><span class="line"></span><br><span class="line">            MessageBox.Show(&quot;Completed!&quot;);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h4 id="15-2-5-Timeline类"><a href="#15-2-5-Timeline类" class="headerlink" title="15.2.5 Timeline类"></a>15.2.5 Timeline类</h4><p>Properties:</p>
<ul>
<li>BeginTime</li>
<li>Duration</li>
<li>SpeedRatio</li>
<li>AccelerationRatio</li>
<li>DecelerationRatio</li>
<li>AutoReverse</li>
<li>FillBehavior</li>
<li>RepeatBehavior</li>
</ul>
<h3 id="15-3-故事板"><a href="#15-3-故事板" class="headerlink" title="15.3 故事板"></a>15.3 故事板</h3><p>​    故事板是BeginAnimation()方法的XAML等价物。通过故事板将动画指定到合适的元素和属性。</p>
<p>​    事件触发器</p>
<h4 id="15-3-1-故事板"><a href="#15-3-1-故事板" class="headerlink" title="15.3.1 故事板"></a>15.3.1 故事板</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">        &lt;local:ArithmeticConverter x:Key=&quot;converter&quot;&gt;&lt;/local:ArithmeticConverter&gt;</span><br><span class="line">    &lt;/Window.Resources&gt;</span><br><span class="line">    &lt;Button Padding=&quot;10&quot; Name=&quot;cmdGrow&quot; Height=&quot;40&quot; Width=&quot;150&quot;</span><br><span class="line">            HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Center&quot;&gt;</span><br><span class="line">        &lt;Button.Triggers&gt;</span><br><span class="line">            &lt;EventTrigger RoutedEvent=&quot;Button.Click&quot;&gt;</span><br><span class="line">                &lt;EventTrigger.Actions&gt;</span><br><span class="line">                    &lt;BeginStoryboard&gt;</span><br><span class="line">                        &lt;Storyboard&gt;</span><br><span class="line">                            &lt;DoubleAnimation Storyboard.TargetProperty=&quot;Width&quot; </span><br><span class="line">                                             To=&quot;&#123;Binding ElementName=window,Path=Width,Converter=&#123;StaticResource converter&#125;,ConverterParameter=-30&#125;&quot;</span><br><span class="line">                                             Duration=&quot;0:0:5&quot;&gt;&lt;/DoubleAnimation&gt;</span><br><span class="line">                            &lt;DoubleAnimation Storyboard.TargetProperty=&quot;Height&quot;</span><br><span class="line">                                             To=&quot;&#123;Binding ElementName=window,Path=Height,Converter=</span><br><span class="line">                                &#123;StaticResource converter&#125;,ConverterParameter=-50&#125;&quot; Duration=&quot;0:0:5&quot;&gt;&lt;/DoubleAnimation&gt;</span><br><span class="line">                        &lt;/Storyboard&gt;</span><br><span class="line">                    &lt;/BeginStoryboard&gt;</span><br><span class="line">                &lt;/EventTrigger.Actions&gt;</span><br><span class="line">            &lt;/EventTrigger&gt;</span><br><span class="line">        &lt;/Button.Triggers&gt;</span><br><span class="line">        &lt;Button.Content&gt;</span><br><span class="line">            Click to make me G</span><br><span class="line">        &lt;/Button.Content&gt;</span><br><span class="line">    &lt;/Button&gt;</span><br></pre></td></tr></table></figure>
<h4 id="15-3-2-事件触发器"><a href="#15-3-2-事件触发器" class="headerlink" title="15.3.2 事件触发器"></a>15.3.2 事件触发器</h4><p>可在如下4个位置定义事件触发器</p>
<ul>
<li>样式里</li>
<li>数据模板中</li>
<li>控件模板中</li>
<li>元素中</li>
</ul>
<p>如果需要相对窗口的尺寸设置，而不是硬编码300个单位。需要使用数据绑定表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;DoubleAnimation Storyboard.TargetProperty=&quot;Width&quot; To=&quot;&#123;Binding ElementName=window,</span><br><span class="line">Path=Width&#125;&quot; Duration=&quot;0:0:5&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>这仍不能得到准确结果，需要构建能够自动完成工作的IValueConverter接口。</p>
<p>Style方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;Window.Resources&gt;</span><br><span class="line">        &lt;Style x:Key=&quot;GrowButtonStyle&quot;&gt;</span><br><span class="line">            &lt;Style.Triggers&gt;</span><br><span class="line">                &lt;Trigger Property=&quot;Button.IsPressed&quot; Value=&quot;True&quot;&gt;</span><br><span class="line">                    &lt;Trigger.EnterActions&gt;</span><br><span class="line">                        &lt;BeginStoryboard&gt;</span><br><span class="line">                            &lt;Storyboard&gt;</span><br><span class="line">                                &lt;DoubleAnimation Storyboard.TargetProperty=&quot;Width&quot;</span><br><span class="line">                                                 To=&quot;250&quot; Duration=&quot;0:0:5&quot;&gt;&lt;/DoubleAnimation&gt;</span><br><span class="line">                            &lt;/Storyboard&gt;</span><br><span class="line">                        &lt;/BeginStoryboard&gt;</span><br><span class="line">                    &lt;/Trigger.EnterActions&gt;</span><br><span class="line">                &lt;/Trigger&gt;</span><br><span class="line">            &lt;/Style.Triggers&gt;</span><br><span class="line">        &lt;/Style&gt;</span><br><span class="line">    &lt;/Window.Resources&gt;</span><br><span class="line">    &lt;Button Padding=&quot;10&quot; Name=&quot;cmdGrow&quot; Height=&quot;40&quot; Width=&quot;160&quot; Style=&quot;&#123;StaticResource GrowButtonStyle&#125;&quot;</span><br><span class="line">            HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Center&quot;&gt;CLikd&lt;/Button&gt;</span><br></pre></td></tr></table></figure>
<h4 id="15-3-3-重叠动画"><a href="#15-3-3-重叠动画" class="headerlink" title="15.3.3 重叠动画"></a>15.3.3 重叠动画</h4><p>用BeginStoryboard.HandoffBehavior属性改变处理动画重叠的方式/</p>
<p>推荐一旦动画完成就手动释放动画时钟。</p>
<h4 id="15-3-4-同步的动画"><a href="#15-3-4-同步的动画" class="headerlink" title="15.3.4 同步的动画"></a>15.3.4 同步的动画</h4><p>​    考虑FillBehavior的行为。是否HoldEnd</p>
<h4 id="15-3-5-控制播放"><a href="#15-3-5-控制播放" class="headerlink" title="15.3.5 控制播放"></a>15.3.5 控制播放</h4><p>动作类继承自ControllableStoryboardAction类</p>
<ul>
<li>PauseStoryboard</li>
<li>ResumeStoryboard</li>
<li>StopStoryboard</li>
<li>SeekStoryboard</li>
<li>SetStoryboardSpeedRatio</li>
<li>SkipStoryboardToFill</li>
<li>RemoveStoryboard</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;Window.Triggers&gt;</span><br><span class="line">       &lt;EventTrigger SourceName=&quot;cmdStart&quot; RoutedEvent=&quot;Button.Click&quot;&gt;</span><br><span class="line">           &lt;BeginStoryboard Name=&quot;fadeStoryboardBegin&quot;&gt;</span><br><span class="line">               &lt;Storyboard Name=&quot;fadeStoryboard&quot; CurrentTimeInvalidated=&quot;storyboard_CurrentTimeInvalidated&quot;</span><br><span class="line">                           SpeedRatio=&quot;&#123;Binding ElementName=sldSpeed,Path=Value&#125;&quot;&gt;</span><br><span class="line">                   &lt;DoubleAnimation Storyboard.TargetName=&quot;imgDay&quot; Storyboard.TargetProperty=&quot;Opacity&quot;</span><br><span class="line">                                    From=&quot;1&quot; To=&quot;0&quot; Duration=&quot;0:0:10&quot;&gt;&lt;/DoubleAnimation&gt;</span><br><span class="line">               &lt;/Storyboard&gt;</span><br><span class="line">           &lt;/BeginStoryboard&gt;</span><br><span class="line">       &lt;/EventTrigger&gt;</span><br><span class="line"></span><br><span class="line">       &lt;EventTrigger SourceName=&quot;cmdPause&quot; RoutedEvent=&quot;Button.Click&quot;&gt;</span><br><span class="line">           &lt;PauseStoryboard BeginStoryboardName=&quot;fadeStoryboardBegin&quot;&gt;&lt;/PauseStoryboard&gt;</span><br><span class="line">       &lt;/EventTrigger&gt;</span><br><span class="line">       &lt;EventTrigger SourceName=&quot;cmdResume&quot; RoutedEvent=&quot;Button.Click&quot;&gt;</span><br><span class="line">           &lt;ResumeStoryboard BeginStoryboardName=&quot;fadeStoryboardBegin&quot;&gt;&lt;/ResumeStoryboard&gt;</span><br><span class="line">       &lt;/EventTrigger&gt;</span><br><span class="line">       &lt;EventTrigger SourceName=&quot;cmdStop&quot; RoutedEvent=&quot;Button.Click&quot;&gt;</span><br><span class="line">           &lt;StopStoryboard BeginStoryboardName=&quot;fadeStoryboardBegin&quot;&gt;&lt;/StopStoryboard&gt;</span><br><span class="line">       &lt;/EventTrigger&gt;</span><br><span class="line">       &lt;EventTrigger SourceName=&quot;cmdMiddle&quot; RoutedEvent=&quot;Button.Click&quot;&gt;</span><br><span class="line">           &lt;SeekStoryboard BeginStoryboardName=&quot;fadeStoryboardBegin&quot;</span><br><span class="line">                           Offset=&quot;0:0:5&quot;&gt;&lt;/SeekStoryboard&gt;</span><br><span class="line">       &lt;/EventTrigger&gt;</span><br><span class="line">       </span><br><span class="line">   &lt;/Window.Triggers&gt;</span><br><span class="line">   &lt;Window.Resources&gt;</span><br><span class="line">       &lt;Style TargetType=&quot;&#123;x:Type Button&#125;&quot;&gt;</span><br><span class="line">           &lt;Setter Property=&quot;Padding&quot; Value=&quot;5&quot;/&gt;</span><br><span class="line">           &lt;Setter Property=&quot;Margin&quot; Value=&quot;1&quot;/&gt;</span><br><span class="line">       &lt;/Style&gt;</span><br><span class="line">   &lt;/Window.Resources&gt;</span><br><span class="line"></span><br><span class="line">   &lt;Grid&gt;</span><br><span class="line">       &lt;Grid.RowDefinitions&gt;</span><br><span class="line">           &lt;RowDefinition&gt;&lt;/RowDefinition&gt;</span><br><span class="line">           &lt;RowDefinition Height=&quot;Auto&quot;&gt;&lt;/RowDefinition&gt;</span><br><span class="line">           &lt;RowDefinition Height=&quot;Auto&quot;&gt;&lt;/RowDefinition&gt;</span><br><span class="line">           &lt;RowDefinition Height=&quot;Auto&quot;&gt;&lt;/RowDefinition&gt;</span><br><span class="line">           &lt;RowDefinition Height=&quot;Auto&quot;&gt;&lt;/RowDefinition&gt;</span><br><span class="line">       &lt;/Grid.RowDefinitions&gt;</span><br><span class="line">       &lt;Grid&gt;</span><br><span class="line">           &lt;Image Source=&quot;night.jpg&quot;&gt;&lt;/Image&gt;</span><br><span class="line">           &lt;Image Source=&quot;day.jpg&quot; Name=&quot;imgDay&quot;&gt;&lt;/Image&gt;</span><br><span class="line">       &lt;/Grid&gt;</span><br><span class="line"></span><br><span class="line">       &lt;StackPanel Grid.Row=&quot;1&quot; Orientation=&quot;Horizontal&quot; HorizontalAlignment=&quot;Center&quot; Margin=&quot;5&quot;&gt;</span><br><span class="line">           &lt;Button Name=&quot;cmdStart&quot;&gt;Start&lt;/Button&gt;</span><br><span class="line">           &lt;Button Name=&quot;cmdPause&quot;&gt;Pause&lt;/Button&gt;</span><br><span class="line">           &lt;Button Name=&quot;cmdResume&quot;&gt;Resume&lt;/Button&gt;</span><br><span class="line">           &lt;Button Name=&quot;cmdStop&quot;&gt;Stop&lt;/Button&gt;</span><br><span class="line">           &lt;Button Name=&quot;cmdMiddle&quot;&gt;Move to Middle&lt;/Button&gt;</span><br><span class="line">       &lt;/StackPanel&gt;</span><br><span class="line"></span><br><span class="line">       &lt;TextBlock Grid.Row=&quot;2&quot; Name=&quot;lblTime&quot; HorizontalAlignment=&quot;Center&quot;&gt;[[stopped]]&lt;/TextBlock&gt;</span><br><span class="line">       &lt;Grid Grid.Row=&quot;3&quot; Margin=&quot;5&quot;&gt;</span><br><span class="line">           &lt;Grid.ColumnDefinitions&gt;</span><br><span class="line">               &lt;ColumnDefinition Width=&quot;Auto&quot;&gt;&lt;/ColumnDefinition&gt;</span><br><span class="line">               &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;</span><br><span class="line">           &lt;/Grid.ColumnDefinitions&gt;</span><br><span class="line">           &lt;TextBlock&gt;Speed:&lt;/TextBlock&gt;</span><br><span class="line">           &lt;Slider Grid.Column=&quot;1&quot; Name=&quot;sldSpeed&quot; Minimum=&quot;0&quot; Maximum=&quot;3&quot; Value=&quot;1&quot; TickPlacement=&quot;BottomRight&quot;</span><br><span class="line">                   TickFrequency=&quot;0.1&quot; ValueChanged=&quot;sldSpeed_ValueChanged&quot;&gt;&lt;/Slider&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       &lt;/Grid&gt;</span><br><span class="line">       &lt;ProgressBar Grid.Row=&quot;4&quot; Margin=&quot;0,5,0,0&quot; Height=&quot;10&quot; Name=&quot;progressBar&quot; Minimum=&quot;0&quot; Maximum=&quot;1&quot;&gt;&lt;/ProgressBar&gt;</span><br><span class="line">   &lt;/Grid&gt;</span><br></pre></td></tr></table></figure>
<p>注意EventTrigger的事件绑定</p>
<p>只能代码方法设置Clock对象检索当前时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">private void storyboard_CurrentTimeInvalidated(object sender,EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Clock storyboardClock = (Clock)sender;</span><br><span class="line">            if (storyboardClock.CurrentProgress==null)</span><br><span class="line">            &#123;</span><br><span class="line">                lblTime.Text = &quot;[[ stopped ]]&quot;;</span><br><span class="line">                progressBar.Value = 0;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                lblTime.Text = storyboardClock.CurrentTime.ToString();</span><br><span class="line">                progressBar.Value = (double)storyboardClock.CurrentProgress;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="15-4-动画缓动"><a href="#15-4-动画缓动" class="headerlink" title="15.4 动画缓动"></a>15.4 动画缓动</h3><p>线性动画太机械，可以使用曲线动画提高体感。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;DoubleAnimation.EasingFunction&gt;</span><br><span class="line">	&lt;ElasticEase EasingMode=&quot;EaseOut&quot; Oscillations=&quot;10&quot;&gt;&lt;/ElasticEase&gt;</span><br><span class="line">&lt;/DoubleAnimation.EasingFunction&gt;</span><br></pre></td></tr></table></figure>
<h4 id="15-4-3-缓动函数类"><a href="#15-4-3-缓动函数类" class="headerlink" title="15.4.3 缓动函数类"></a>15.4.3 缓动函数类</h4><p>每个缓动函数类还提供了EasingMode属性，用于控制是EaseIn  EaseOut or EaseInOut</p>
<ul>
<li>BackEase</li>
<li>ElasticEase</li>
<li>BounceEase</li>
<li>CircleEase</li>
<li>CubicEase</li>
<li>QuadraticEase</li>
<li>QuarticEase</li>
<li>QuinticEase</li>
<li>SineEase</li>
<li>PowerEase</li>
<li>ExponentialEase</li>
</ul>
<h4 id="15-4-4-创建自定义缓动函数"><a href="#15-4-4-创建自定义缓动函数" class="headerlink" title="15.4.4 创建自定义缓动函数"></a>15.4.4 创建自定义缓动函数</h4><p><strong>Skipppppppppppppppppppppppppp</strong></p>
<hr>
<h3 id="15-5-Animation-Performance"><a href="#15-5-Animation-Performance" class="headerlink" title="15.5  Animation Performance"></a>15.5  Animation Performance</h3><h4 id="15-5-1-Desired-Frame-Rate"><a href="#15-5-1-Desired-Frame-Rate" class="headerlink" title="15.5.1 Desired Frame Rate"></a>15.5.1 Desired Frame Rate</h4><h4 id="15-5-2-BitmapCaching-位图缓存"><a href="#15-5-2-BitmapCaching-位图缓存" class="headerlink" title="15.5.2 BitmapCaching 位图缓存"></a>15.5.2 BitmapCaching 位图缓存</h4><h3 id="15-6-小结"><a href="#15-6-小结" class="headerlink" title="15.6 小结"></a>15.6 小结</h3><p>​    本章详细分析了WPF动画支持，学习了基本的动画类和线程插值，学习了故事板控制一个或者多个动画的播放，以及如何使用动画缓动创建更趋自然的效果。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/learn-everday/" rel="tag"># learn everday</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/21/WPF-Advanced-Animations/" rel="next" title="WPF Advanced Animations">
                <i class="fa fa-chevron-left"></i> WPF Advanced Animations
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Psmyfish</p>
              <p class="site-description motion-element" itemprop="description">Some fish in the rain,some fish in the sun.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#WPF-Classic"><span class="nav-number">1.</span> <span class="nav-text">WPF Classic</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#WPF-Introduction"><span class="nav-number">1.1.</span> <span class="nav-text">WPF Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-WPF体系结构"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.4 WPF体系结构</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Core-Class"><span class="nav-number">1.1.1.0.0.1.</span> <span class="nav-text">Core Class</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-Conclusion"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.6 Conclusion</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XAML"><span class="nav-number">1.2.</span> <span class="nav-text">XAML</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-XAML-basic"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.2 XAML basic</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-Xaml中的属性和事件"><span class="nav-number">1.3.</span> <span class="nav-text">2.3 Xaml中的属性和事件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WFP-Layout"><span class="nav-number">1.4.</span> <span class="nav-text">WFP Layout</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Panel"><span class="nav-number">1.4.0.0.0.1.</span> <span class="nav-text">Panel</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2Layout-Property"><span class="nav-number">1.4.1.</span> <span class="nav-text">3.2Layout Property</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">3.2.1</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Conclusion"><span class="nav-number">1.4.2.</span> <span class="nav-text">Conclusion</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Dependency-Properties"><span class="nav-number">1.5.</span> <span class="nav-text">4.Dependency Properties</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Routed-Events"><span class="nav-number">1.5.1.</span> <span class="nav-text">Routed Events</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-RoutedEventArgs"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">5.2.1 RoutedEventArgs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Attached-Events"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">Attached Events</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WPF-EVents"><span class="nav-number">1.5.2.</span> <span class="nav-text">WPF EVents</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Lifetime-Events"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">Lifetime Events</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Input-Events"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">Input Events</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Keyboard-Input"><span class="nav-number">1.5.3.</span> <span class="nav-text">Keyboard Input</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Handling-a-Key-Press"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">Handling a Key Press</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Focus"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">Focus</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Getting-Key-State"><span class="nav-number">1.5.3.3.</span> <span class="nav-text">Getting Key State</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mouse-Input"><span class="nav-number">1.5.4.</span> <span class="nav-text">Mouse Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Multitouch-Input"><span class="nav-number">1.5.5.</span> <span class="nav-text">Multitouch Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-last-world"><span class="nav-number">1.5.6.</span> <span class="nav-text">The last world</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Controls"><span class="nav-number">1.6.</span> <span class="nav-text">Controls</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Control-Class"><span class="nav-number">1.6.1.</span> <span class="nav-text">The Control Class</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Background-and-Foreground"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">Background and Foreground</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fonts"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">Fonts</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mouse-Cursors"><span class="nav-number">1.6.1.3.</span> <span class="nav-text">Mouse Cursors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fonts-1"><span class="nav-number">1.6.1.4.</span> <span class="nav-text">Fonts</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mouse-Cursors-1"><span class="nav-number">1.6.1.5.</span> <span class="nav-text">Mouse Cursors</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Content-Controls"><span class="nav-number">1.6.2.</span> <span class="nav-text">Content Controls</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-1-Content-属性"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">6.2.1 Content 属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-Specialized-Containers"><span class="nav-number">1.6.3.</span> <span class="nav-text">6.3 Specialized Containers</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-1-ScrollViewer"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">6.3.1  ScrollViewer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-2-GroupBox"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">6.3.2  GroupBox</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-3-TabItem"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">6.3.3  TabItem</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-4-Expander"><span class="nav-number">1.6.3.4.</span> <span class="nav-text">6.3.4 Expander</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-5-Text-Controls"><span class="nav-number">1.6.3.5.</span> <span class="nav-text">6.3.5 Text Controls</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-6-Multiple-Lines-of-Text"><span class="nav-number">1.6.3.6.</span> <span class="nav-text">6.3.6 Multiple Lines of Text</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-7-Text-Selection"><span class="nav-number">1.6.3.7.</span> <span class="nav-text">6.3.7 Text Selection</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Spell-Checking"><span class="nav-number">1.6.3.8.</span> <span class="nav-text">Spell Checking</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-8-PasswordBox"><span class="nav-number">1.6.3.9.</span> <span class="nav-text">6.3.8 PasswordBox</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-5-List-Controls"><span class="nav-number">1.6.4.</span> <span class="nav-text">6.5 List Controls</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-5-2-ComboBox"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">6.5.2 ComboBox</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-Range-based-Controls"><span class="nav-number">1.6.5.</span> <span class="nav-text">6.6 Range_based Controls</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-6-1-Slider"><span class="nav-number">1.6.5.1.</span> <span class="nav-text">6.6.1 Slider</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-6-2-ProgressBar"><span class="nav-number">1.6.5.2.</span> <span class="nav-text">6.6.2 ProgressBar</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-7-Date-Controls"><span class="nav-number">1.6.6.</span> <span class="nav-text">6.7  Date Controls</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Text-Controls"><span class="nav-number">1.6.7.</span> <span class="nav-text">Text Controls</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#List-Controls"><span class="nav-number">1.6.8.</span> <span class="nav-text">List Controls</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Range-Based-COntrols"><span class="nav-number">1.6.9.</span> <span class="nav-text">Range_Based COntrols</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Date-Controls"><span class="nav-number">1.6.10.</span> <span class="nav-text">Date Controls</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#THe-last-world"><span class="nav-number">1.6.11.</span> <span class="nav-text">THe last world</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch07-Application-Class"><span class="nav-number">1.7.</span> <span class="nav-text">Ch07 Application Class</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-3-Application-Shutdown"><span class="nav-number">1.7.0.1.</span> <span class="nav-text">7.1.3 Application Shutdown</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-1-显示初始界面"><span class="nav-number">1.7.0.2.</span> <span class="nav-text">7.2.1 显示初始界面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-2-处理命令行参数"><span class="nav-number">1.7.0.3.</span> <span class="nav-text">7.2.2 处理命令行参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-访问当前Application对象"><span class="nav-number">1.7.0.4.</span> <span class="nav-text">7.2.3 访问当前Application对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-4-在窗口之间进行交互"><span class="nav-number">1.7.0.5.</span> <span class="nav-text">7.2.4 在窗口之间进行交互</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-5-单实例应用程序"><span class="nav-number">1.7.0.6.</span> <span class="nav-text">7.2.5 单实例应用程序</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch12-理解形状"><span class="nav-number">1.8.</span> <span class="nav-text">Ch12 理解形状</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-1-Shape-Class"><span class="nav-number">1.8.0.1.</span> <span class="nav-text">12.1.1 Shape Class</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-2-矩形和椭圆"><span class="nav-number">1.8.0.2.</span> <span class="nav-text">12.1.2 矩形和椭圆</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-5-直线"><span class="nav-number">1.8.0.3.</span> <span class="nav-text">12.1.5 直线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-6-amp-7-折线和多边形"><span class="nav-number">1.8.0.4.</span> <span class="nav-text">12.1.6&amp;7  折线和多边形</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-8-直线线帽和直线交点"><span class="nav-number">1.8.0.5.</span> <span class="nav-text">12.1.8 直线线帽和直线交点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-9-点划线"><span class="nav-number">1.8.0.6.</span> <span class="nav-text">12.1.9 点划线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-1-10-像素对齐"><span class="nav-number">1.8.0.7.</span> <span class="nav-text">12.1.10 像素对齐</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-2-画刷"><span class="nav-number">1.8.1.</span> <span class="nav-text">12.2 画刷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-3-变换"><span class="nav-number">1.8.2.</span> <span class="nav-text">12.3 变换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-4-透明"><span class="nav-number">1.8.3.</span> <span class="nav-text">12.4 透明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#12-4-2-透明掩码"><span class="nav-number">1.8.3.1.</span> <span class="nav-text">12.4.2 透明掩码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-5-小结"><span class="nav-number">1.8.4.</span> <span class="nav-text">12.5 小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch13-几何图形和图画"><span class="nav-number">1.9.</span> <span class="nav-text">Ch13 几何图形和图画</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-路径和几何图形"><span class="nav-number">1.9.1.</span> <span class="nav-text">13.1 路径和几何图形</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#13-1-1-直线-矩形和椭圆图形"><span class="nav-number">1.9.1.1.</span> <span class="nav-text">13.1.1 直线 矩形和椭圆图形</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-3-小结"><span class="nav-number">1.9.2.</span> <span class="nav-text">13.3 小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch14-效果和可视化对象"><span class="nav-number">1.10.</span> <span class="nav-text">Ch14  效果和可视化对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#14-1-1-绘制可视化对象"><span class="nav-number">1.10.0.1.</span> <span class="nav-text">14.1.1 绘制可视化对象</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch15-Animate"><span class="nav-number">1.11.</span> <span class="nav-text">Ch15 Animate</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-理解WPF动画"><span class="nav-number">1.11.1.</span> <span class="nav-text">15.1 理解WPF动画</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-1-1-基于时间的动画"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">15.1.1 基于时间的动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-1-2-基于属性的动画"><span class="nav-number">1.11.1.2.</span> <span class="nav-text">15.1.2 基于属性的动画</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-2-基本动画"><span class="nav-number">1.11.2.</span> <span class="nav-text">15.2 基本动画</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-2-1-Animation-Class"><span class="nav-number">1.11.2.1.</span> <span class="nav-text">15.2.1 Animation Class</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-2-2-使用代码创建动画"><span class="nav-number">1.11.2.2.</span> <span class="nav-text">15.2.2 使用代码创建动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-2-3-同时发生的动画"><span class="nav-number">1.11.2.3.</span> <span class="nav-text">15.2.3 同时发生的动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-2-4-动画的生命-周期"><span class="nav-number">1.11.2.4.</span> <span class="nav-text">15.2.4 动画的生命 周期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-2-5-Timeline类"><span class="nav-number">1.11.2.5.</span> <span class="nav-text">15.2.5 Timeline类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-3-故事板"><span class="nav-number">1.11.3.</span> <span class="nav-text">15.3 故事板</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-3-1-故事板"><span class="nav-number">1.11.3.1.</span> <span class="nav-text">15.3.1 故事板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-3-2-事件触发器"><span class="nav-number">1.11.3.2.</span> <span class="nav-text">15.3.2 事件触发器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-3-3-重叠动画"><span class="nav-number">1.11.3.3.</span> <span class="nav-text">15.3.3 重叠动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-3-4-同步的动画"><span class="nav-number">1.11.3.4.</span> <span class="nav-text">15.3.4 同步的动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-3-5-控制播放"><span class="nav-number">1.11.3.5.</span> <span class="nav-text">15.3.5 控制播放</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-4-动画缓动"><span class="nav-number">1.11.4.</span> <span class="nav-text">15.4 动画缓动</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-4-3-缓动函数类"><span class="nav-number">1.11.4.1.</span> <span class="nav-text">15.4.3 缓动函数类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-4-4-创建自定义缓动函数"><span class="nav-number">1.11.4.2.</span> <span class="nav-text">15.4.4 创建自定义缓动函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-5-Animation-Performance"><span class="nav-number">1.11.5.</span> <span class="nav-text">15.5  Animation Performance</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-5-1-Desired-Frame-Rate"><span class="nav-number">1.11.5.1.</span> <span class="nav-text">15.5.1 Desired Frame Rate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-5-2-BitmapCaching-位图缓存"><span class="nav-number">1.11.5.2.</span> <span class="nav-text">15.5.2 BitmapCaching 位图缓存</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-6-小结"><span class="nav-number">1.11.6.</span> <span class="nav-text">15.6 小结</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Psmyfish</span>

  
</div>






  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
