<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Fish, PP" />










<meta name="description" content="C# in Depth">
<meta name="keywords" content="Nice body">
<meta property="og:type" content="article">
<meta property="og:title" content="C# in Depth">
<meta property="og:url" content="http://yoursite.com/2018/06/30/C-in-Depth/index.html">
<meta property="og:site_name" content="Psmyfish">
<meta property="og:description" content="C# in Depth">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/images/002.png">
<meta property="og:image" content="http://yoursite.com/images/003.png">
<meta property="og:updated_time" content="2018-09-14T02:19:54.120Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C# in Depth">
<meta name="twitter:description" content="C# in Depth">
<meta name="twitter:image" content="http://yoursite.com/images/002.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/06/30/C-in-Depth/"/>





  <title>C# in Depth | Psmyfish</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/psmyfish" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Psmyfish</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">what is this fish?</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/30/C-in-Depth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Psmyfish">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Psmyfish">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">C# in Depth</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-30T14:22:39+08:00">
                2018-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C#</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="C-in-Depth"><a href="#C-in-Depth" class="headerlink" title="C# in Depth"></a>C# in Depth</h1><a id="more"></a>
<h2 id="The-changing-face-of-C-development"><a href="#The-changing-face-of-C-development" class="headerlink" title="The changing face of C# development"></a>The changing face of C# development</h2><h3 id="1-1-Starting-with-a-simple-data-type"><a href="#1-1-Starting-with-a-simple-data-type" class="headerlink" title="1.1 Starting with a simple data type"></a>1.1 Starting with a simple data type</h3><h4 id="1-1-1-The-Product-type-in-C-1"><a href="#1-1-1-The-Product-type-in-C-1" class="headerlink" title="1.1.1 The Product type in C#1"></a>1.1.1 The Product type in C#1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.ComponentModel;</span><br><span class="line"></span><br><span class="line">namespace Chapter01.CSharp1</span><br><span class="line">&#123;</span><br><span class="line">    [Description(&quot;Listing 1.01&quot;)]</span><br><span class="line">    public class Product</span><br><span class="line">    &#123;</span><br><span class="line">        string name;</span><br><span class="line">        public string Name</span><br><span class="line">        &#123;</span><br><span class="line">            get &#123; return name; &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        decimal price;</span><br><span class="line">        public decimal Price</span><br><span class="line">        &#123;</span><br><span class="line">            get &#123; return price; &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public Product(string name, decimal price)</span><br><span class="line">        &#123;</span><br><span class="line">            this.name = name;</span><br><span class="line">            this.price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static ArrayList GetSampleProducts()</span><br><span class="line">        &#123;</span><br><span class="line">            ArrayList list = new ArrayList();</span><br><span class="line">            list.Add(new Product(&quot;West Side Story&quot;, 9.99m));</span><br><span class="line">            list.Add(new Product(&quot;Assassins&quot;, 14.99m));</span><br><span class="line">            list.Add(new Product(&quot;Frogs&quot;, 13.99m));</span><br><span class="line">            list.Add(new Product(&quot;Sweeney Todd&quot;, 10.99m));</span><br><span class="line">            return list;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public override string ToString()</span><br><span class="line">        &#123;</span><br><span class="line">            return string.Format(&quot;&#123;0&#125;: &#123;1&#125;&quot;, name, price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-1-2-Strongly-typed-collections-in-C-2"><a href="#1-1-2-Strongly-typed-collections-in-C-2" class="headerlink" title="1.1.2 Strongly typed collections in C#2"></a>1.1.2 Strongly typed collections in C#2</h4><p>The most important change in C# 2: generics</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">// --------------------------------------------------------------------------------------------------------------------</span><br><span class="line">// &lt;copyright file=&quot;TheProductType.cs&quot; company=&quot;psmyfish.top&quot;&gt;</span><br><span class="line">//   pp</span><br><span class="line">// &lt;/copyright&gt;</span><br><span class="line">// &lt;summary&gt;</span><br><span class="line">//   Defines the TheProductType type.</span><br><span class="line">// &lt;/summary&gt;</span><br><span class="line">// --------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">namespace C01</span><br><span class="line">&#123;</span><br><span class="line">    using System.Collections;</span><br><span class="line">    using System.Collections.Generic;</span><br><span class="line">    using System.ComponentModel;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// The the product type.</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    [Description(&quot;Listing 1.01&quot;)]</span><br><span class="line">    public class Product</span><br><span class="line">    &#123;</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// The name.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        private string name;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Gets the name.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        public string Name</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                return name;</span><br><span class="line">            &#125;</span><br><span class="line">            private set</span><br><span class="line">            &#123;</span><br><span class="line">                name = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// The price.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        private decimal price;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Gets the price.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        public decimal Price</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                return price;</span><br><span class="line">            &#125;</span><br><span class="line">            private set</span><br><span class="line">            &#123;</span><br><span class="line">                price = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Initializes a new instance of the &lt;see cref=&quot;Product&quot;/&gt; class.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;name&quot;&gt;</span><br><span class="line">        /// The name.</span><br><span class="line">        /// &lt;/param&gt;</span><br><span class="line">        /// &lt;param name=&quot;price&quot;&gt;</span><br><span class="line">        /// The price.</span><br><span class="line">        /// &lt;/param&gt;</span><br><span class="line">        public Product(string name, decimal price)</span><br><span class="line">        &#123;</span><br><span class="line">            Name = name;</span><br><span class="line">            Price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// The get sample products.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;returns&gt;</span><br><span class="line">        /// The &lt;see cref=&quot;ArrayList&quot;/&gt;.</span><br><span class="line">        /// &lt;/returns&gt;</span><br><span class="line">        public static List&lt;Product&gt; GetSampleProducts()</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;Product&gt; list = new List&lt;Product&gt;();             </span><br><span class="line">            list.Add(new Product(&quot;West Side Story&quot;, 9.99m));</span><br><span class="line">            list.Add(new Product(&quot;Assassins&quot;, 14.99m));</span><br><span class="line">            list.Add(new Product(&quot;Frogs&quot;, 13.99m));</span><br><span class="line">            list.Add(new Product(&quot;Sweeney Todd&quot;, 10.99m));</span><br><span class="line">            return list;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// The to string.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;returns&gt;</span><br><span class="line">        /// The &lt;see cref=&quot;string&quot;/&gt;.</span><br><span class="line">        /// &lt;/returns&gt;</span><br><span class="line">        public override string ToString()</span><br><span class="line">        &#123;</span><br><span class="line">            return string.Format(&quot;&#123;0&#125;:&#123;1&#125;&quot;, name, price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-1-3-Automatically-implemented-properties-in-C-3"><a href="#1-1-3-Automatically-implemented-properties-in-C-3" class="headerlink" title="1.1.3 Automatically implemented properties in C#3"></a>1.1.3 Automatically implemented properties in C#3</h4><p>The automatically implemented properties and simplified initialization shown in the following listing are relatively trivial.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">namespace C01</span><br><span class="line">&#123;</span><br><span class="line">    using System.Collections.Generic;</span><br><span class="line"></span><br><span class="line">    class Product</span><br><span class="line">    &#123;</span><br><span class="line">        public string Name &#123; get; private set; &#125;</span><br><span class="line">        public decimal Price &#123; get; private set; &#125;</span><br><span class="line"></span><br><span class="line">        public Product(string name, decimal price)</span><br><span class="line">        &#123;</span><br><span class="line">            Name = name;</span><br><span class="line">            Price = price;</span><br><span class="line">        &#125;</span><br><span class="line">        Product() &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public static List&lt;Product&gt; GetSampleProducts()</span><br><span class="line">        &#123;</span><br><span class="line">            return new List&lt;Product&gt;</span><br><span class="line">                       &#123;</span><br><span class="line">                           new Product &#123; Name = &quot;West&quot;, Price = 9.99m &#125;,</span><br><span class="line">                           new Product &#123; Name = &quot;Assassins&quot;, Price = 14.99m &#125;,</span><br><span class="line">                           new Product &#123; Name = &quot;Frogs&quot;, Price = 13.99m &#125;,</span><br><span class="line">                           new Product &#123; Name = &quot;Sweeney Todd&quot;, Price = 10.99m &#125;</span><br><span class="line">                       &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public override string ToString()</span><br><span class="line">        &#123;</span><br><span class="line">            return string.Format(&quot;&#123;0&#125;,&#123;1&#125;&quot;, Name, Price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-1-4-Name-arguments-in-C-4"><a href="#1-1-4-Name-arguments-in-C-4" class="headerlink" title="1.1.4 Name arguments in C# 4"></a>1.1.4 Name arguments in C# 4</h4><p>This gives you the clarity of C# 3 initializers without  the mutability.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line"></span><br><span class="line">    class Product</span><br><span class="line">    &#123;</span><br><span class="line">        readonly string name;</span><br><span class="line">        public string Name &#123; get&#123; return name; &#125; &#125;</span><br><span class="line"></span><br><span class="line">        private readonly decimal price;</span><br><span class="line">        public decimal Price &#123; get&#123; return price; &#125; &#125;</span><br><span class="line"></span><br><span class="line">        public Product(string name, decimal price)</span><br><span class="line">        &#123;</span><br><span class="line">            this.name = name;</span><br><span class="line">            this.price = price;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static List&lt;Product&gt; GetSampleProducts()</span><br><span class="line">        &#123;</span><br><span class="line">            return new List&lt;Product&gt;</span><br><span class="line">                       &#123;</span><br><span class="line">                           new Product(name: &quot;West&quot;, price: 9.99m),</span><br><span class="line">                           new Product(name:&quot;Assassins&quot;, price: 14.99m),</span><br><span class="line">                           new Product(name:&quot;Frogs&quot;, price: 13.99m),</span><br><span class="line">                           new Product(name:&quot;Sweeney Todd&quot;, price: 10.99m)</span><br><span class="line">                       &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public override string ToString()</span><br><span class="line">        &#123;</span><br><span class="line">            return string.Format(&quot;&#123;0&#125;,&#123;1&#125;&quot;, Name, Price);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>Here is the summarizes.</p>
<p><img src="/images/002.png" alt="001"></p>
<h3 id="1-2-Sorting-and-filtering"><a href="#1-2-Sorting-and-filtering" class="headerlink" title="1.2 Sorting and filtering"></a>1.2 Sorting and filtering</h3><h4 id="1-2-1-Sorting-products-by-name"><a href="#1-2-1-Sorting-products-by-name" class="headerlink" title="1.2.1 Sorting products by name"></a>1.2.1 Sorting products by name</h4><p>if you use this</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">    using System.Collections;</span><br><span class="line">    using System.ComponentModel;</span><br><span class="line"></span><br><span class="line">    [Description(&quot;Listing 1.05&quot;)]</span><br><span class="line">    class ArrayListSort</span><br><span class="line">    &#123;</span><br><span class="line">        class ProductNameComparer : IComparer</span><br><span class="line">        &#123;</span><br><span class="line">            public int Compare(object x, object y)</span><br><span class="line">            &#123;</span><br><span class="line">                Product first = (Product)x;</span><br><span class="line">                Product second = (Product)y;</span><br><span class="line">                return first.Name.CompareTo(second.Name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            ArrayList products = Product.GetSampleProducts();</span><br><span class="line">            products.Sort(new ProductNameComparer());</span><br><span class="line">            foreach (Product product in products)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(product);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>Casts are used but you cant ensure that you are right.The <code>(Product)</code> &amp; cw(product) have a chance to go bang.</p>
<p>But if you use Generic as the only change.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[Description(&quot;Listing 1.05&quot;)]</span><br><span class="line">    class ArrayListSort</span><br><span class="line">    &#123;</span><br><span class="line">        class ProductNameComparer : IComparer&lt;Product&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            public int Compare(Product x,Product y)</span><br><span class="line">            &#123;</span><br><span class="line">                return x.Name.CompareTo(y.Name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">            products.Sort(new ProductNameComparer());</span><br><span class="line">            foreach (Product product in products)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(product);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>The following listing shows how to do precisely this,telling the Sort method how to compare two products using a delegate.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class ArrayListSort</span><br><span class="line">    &#123;</span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">            products.Sort(delegate(Product x, Product y) </span><br><span class="line">            &#123; return x.Name.CompareTo(y.Name); &#125;);</span><br><span class="line">            foreach (Product product in products)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(product);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>Behold the lack  of  the ProductNameComparer type.</p>
<blockquote>
<p>Listing 1.8 Sorting using Comparison<product> from a lambda expression</product></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">products.Sort((x,y)=&gt;x.Name.CompareTo(y.Name));</span><br></pre></td></tr></table></figure>
<p>There is more, though: with C# 3, you can sasily print out the names in order without modifying the original list of products.The next listing shows this using the OrderBy method.</p>
<blockquote>
<p>Listing 1.9 Ordering a List<product> using an extension method(C# 3)</product></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">foreach (Product product in products.OrderBy(p =&gt;p.Name))</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(product);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You’re able to call the OrderBy method due to the presence of an extension method.</p>
<p><img src="/images/003.png" alt="003"></p>
<h4 id="1-2-2-Querying-collections"><a href="#1-2-2-Querying-collections" class="headerlink" title="1.2.2 Querying collections"></a>1.2.2 Querying collections</h4><p>Your next task is to find all the elements of the list that match a certain criterion- in particular ,those with a price greater than $10.</p>
<blockquote>
<p>Listing 1.10 Looping,testing,printing out( C# 1)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ArrayList products= Product.GetSampleProducts();</span><br><span class="line">foreach(Product product in products)</span><br><span class="line">&#123;</span><br><span class="line">    if(product.Price&gt;10m)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(product);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The following listing demonstrates how C#2 lets you flatten things out a bit.</p>
<blockquote>
<p>Listing 1.11 Separating testing from printing (C# 2)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">            Predicate&lt;Product&gt; test = delegate(Product p) &#123; return p.Price &gt; 10m; &#125;;</span><br><span class="line">            List&lt;Product&gt; matches = products.FindAll(test);</span><br><span class="line">            Action&lt;Product&gt; print = Console.WriteLine;</span><br><span class="line">            matches.ForEach(print);</span><br></pre></td></tr></table></figure>
<p>The print variable initialization uses another new C# 2 feature called <strong>method group conversions </strong>that make it easier to create delegates from existing methods.</p>
<blockquote>
<p>Listing 1.12 Separating testing from printing redux(C# 2)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">            products.FindAll(delegate(Product p) &#123; return p.Price &gt; 10; &#125;).</span><br><span class="line">                ForEach(Console.WriteLine);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Listing 1.13 Testing with a lambda expression(C# 3)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">foreach(Product product in products.Where(p=&gt;p.Price&gt;10))</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(product);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-3-1-Representing-an-unknown-price"><a href="#1-3-1-Representing-an-unknown-price" class="headerlink" title="1.3.1 Representing an unknown price"></a>1.3.1 Representing an unknown price</h4><p>.NET 2.0 makes matters a lot simpler by introducing the Nullable<t> structure, and C# 2 provides some additional syntactic sugar that lets you change the property declaration to this block of code:</t></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">decimal?price;</span><br><span class="line">public decimal?Price</span><br><span class="line">&#123;</span><br><span class="line">	get&#123;return price;&#125;</span><br><span class="line">	private set &#123;price= value;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Listing 1.14 Displaying products with an unknown price(C# 3)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">foreach(Product product in products.Where(p=&gt;p.Price==null))</span><br><span class="line">&#123;</span><br><span class="line">    cw(product.Name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>the C# 2 code</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">products.FindAll(delegate(Product p)&#123;return p.Price==null;&#125;).ForEach(Console.WriteLine);</span><br></pre></td></tr></table></figure>
<h4 id="1-3-2-Optional-parameters-and-default-values"><a href="#1-3-2-Optional-parameters-and-default-values" class="headerlink" title="1.3.2 Optional parameters and default values"></a>1.3.2 Optional parameters and default values</h4><p>optional parameters </p>
<p>let’s suppose that most of the products dont have prices. It would be nice to be able to initialize a product like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Product p = new Product(&quot;Unreleased product&quot;);</span><br></pre></td></tr></table></figure>
<p>C#4 allows your to declare a default value for the price parameter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public Product(string name,decimal? price=null)</span><br><span class="line">&#123;</span><br><span class="line">	this.name=name;</span><br><span class="line">	this.price= price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-4-Introducing-LINQ"><a href="#1-4-Introducing-LINQ" class="headerlink" title="1.4 Introducing LINQ"></a>1.4 Introducing LINQ</h3><h4 id="1-4-1-Query-expressions-and-in-process-queries"><a href="#1-4-1-Query-expressions-and-in-process-queries" class="headerlink" title="1.4.1 Query expressions and in-process queries"></a>1.4.1 Query expressions and in-process queries</h4><blockquote>
<p>Listing 1.15 First steps with query expressions:filtering acollection</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">            var filtered = from Product p in products</span><br><span class="line">                           where p.Price &gt; 10</span><br><span class="line">                           select p;</span><br><span class="line">            foreach (Product product in filtered)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(product);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Listing 1.16</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products = Product.GetSampleProducts();</span><br><span class="line">List&lt;Supplier&gt; suppliers = Supplier.GetSampleSuppliers();</span><br><span class="line">            var filtered = from p in products</span><br><span class="line">                           join s in suppliers</span><br><span class="line">                           on p.SupplierID equals s.SupplierID</span><br><span class="line">                           where p.Price &gt; 10</span><br><span class="line">                           orderby s.Name, p.Name</span><br><span class="line">                           select new &#123; SupplierName = s.Name, ProductName = p.Name &#125;;</span><br><span class="line">            foreach (var v in filtered)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(&quot;Supplier=&#123;0&#125;,Product=&#123;1&#125;&quot;, v.SupplierName, v.ProductName);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Listing 1.19</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">using Microsoft.Office.Interop.Excel;</span><br><span class="line">var app = new Application &#123; Visible = false &#125;;</span><br><span class="line">            Workbook workbook = app.Workbooks.Add();</span><br><span class="line">            Worksheet worksheet = app.ActiveSheet;</span><br><span class="line">            int row = 1;</span><br><span class="line">            foreach (var product in Product.GetSampleProducts()</span><br><span class="line">                                           .Where(p =&gt; p.Price != null))</span><br><span class="line">            &#123;</span><br><span class="line">                worksheet.Cells[row, 1].Value = product.Name;</span><br><span class="line">                worksheet.Cells[row, 2].Value = product.Price;</span><br><span class="line">                row++;</span><br><span class="line">            &#125;</span><br><span class="line">            workbook.SaveAs(Filename: &quot;demo.xls&quot;,</span><br><span class="line">                            FileFormat: XlFileFormat.xlWorkbookNormal);</span><br><span class="line">            app.Application.Quit();</span><br></pre></td></tr></table></figure>
<h2 id="Core-foundations-building-on-C-1"><a href="#Core-foundations-building-on-C-1" class="headerlink" title="Core foundations:building on C#1"></a>Core foundations:building on C#1</h2><h3 id="2-1-Delegates"><a href="#2-1-Delegates" class="headerlink" title="2.1 Delegates"></a>2.1 Delegates</h3><p>委托不需要直接指定一个要执行的行为，而是将这个行为用某种方式“包含”在一个对象中。。这个对象可以像其他任何对象那样使用。在该对象中，可以执行封装的操作。</p>
<p>可以选择将委托类型看作只定义了一个方法的接口，将委托的实例看做实现了哪一个接口的一个对象。</p>
<h4 id="2-1-1-A-recipe-for-simple-delegates"><a href="#2-1-1-A-recipe-for-simple-delegates" class="headerlink" title="2.1.1 A recipe for simple delegates"></a>2.1.1 A recipe for simple delegates</h4><p>委托成立条件</p>
<ul>
<li>The delegate type needs to be declared.</li>
<li>The code to be executed must be contained in a method</li>
<li>A delegate instance must be created</li>
<li>The delegate instance must be invoked.</li>
</ul>
<p>声明：<code>delegate void StringProcessor(string input)</code></p>
<p>Note：区分委托类型和 委托实例</p>
<p>创建一个StringProcessor实例的两个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">StringProcessor proc1,proc2;</span><br><span class="line">proc1= new StringProcessor(StaticMethods.PrintString);</span><br><span class="line">InstanceMethods instance = new InstanceMethods();</span><br><span class="line">proc2 = new StringProcessor(instance.PrintString);</span><br></pre></td></tr></table></figure>
<p><strong>调用委托实例</strong></p>
<p>void Invoke(string input)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">using System;;</span><br><span class="line">delegate void StringProcessor(string input);</span><br><span class="line">class Person&#123;</span><br><span class="line">	string name;</span><br><span class="line">	public Person(string name)&#123;this.name=name;&#125;</span><br><span class="line">	public void Say(string message)</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(&quot;&#123;0&#125; says:&#123;1&#125;&quot;,name,message);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Background</span><br><span class="line">&#123;</span><br><span class="line">	public static void Note(string note)</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(&quot;(&#123;0&#125;)&quot;,note);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">class SimpleDelegateUse</span><br><span class="line">&#123;</span><br><span class="line">	static void Main()</span><br><span class="line">	&#123;</span><br><span class="line">		Person jon= new Person(&quot;Jon&quot;);</span><br><span class="line">		Person tom = new Person(&quot;Tom&quot;);</span><br><span class="line">		StringProcessor jonsVoice,tomsVoice,backgrond;</span><br><span class="line">		jonsVoice = new StringProcessor(jon.Say);</span><br><span class="line">		tomsVoice = new StringProcessor(tom.Say);</span><br><span class="line">		backgrond = new StringProcessor(Background.Note);</span><br><span class="line">		jonsVoice(&quot;Hello,son.&quot;);</span><br><span class="line">		tomsVoice.Invoke(&quot;Hello,Daddy!&quot;);</span><br><span class="line">		backgrond(&quot;An airplane flied past.&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-2-Combining-and-removing-delegates"><a href="#2-1-2-Combining-and-removing-delegates" class="headerlink" title="2.1.2 Combining and removing delegates"></a>2.1.2 Combining and removing delegates</h4><p>委托实例的调用列表i（invocation list）System.Delegate类型的静态方法Combine 和Remove。</p>
<blockquote>
<p>Note:委托是不易变的 创建了委托实例后，有关它的一切就不能改变。这样一来就可以安全地传递委托实例的引用。委托和string是一样的。Delegate.Combine 和String.Concat很像。如果把null和委托实例合并到一起，null将被视为带有空调用列表的一个委托</p>
</blockquote>
<p>Delegate.Combine很少显式调用，一般用+ 和+=</p>
<p>Invoke 的返回值是最后一个操作的返回值</p>
<p>如果中间有异常，会立刻“传播”</p>
<h4 id="2-1-3-A-brief-diversion-into-events"><a href="#2-1-3-A-brief-diversion-into-events" class="headerlink" title="2.1.3 A brief diversion into events"></a>2.1.3 A brief diversion into events</h4><p>事件不是委托类型的字段。对于一个纯粹的事件，你所能做的就是订阅（add） 和取消订阅(remove).</p>
<h4 id="2-1-4-Summary-of-delegates"><a href="#2-1-4-Summary-of-delegates" class="headerlink" title="2.1.4 Summary of delegates"></a>2.1.4 Summary of delegates</h4><ul>
<li>委托封装了包含特殊返回类型和一组参数的行为，类似包含单一方法的接口</li>
<li>委托类型声明中所描述的类型签名决定了哪个方法可以用于创建委托实例，同时决定了调用的签名</li>
<li>为了创建委托实例，需要一个方法以及（对于实例方法来说）调用方法的目标</li>
<li>委托实例是不易变的</li>
<li>每个委托实例都包含一个调用列表– 一个操作列表</li>
<li>委托实例可以合并到一起，也可以从一个委托实例中删除另一个</li>
<li>事件不是委托实例–只是成对的add/remove方法（类似于属性的取值方法/赋值方法）</li>
</ul>
<h3 id="2-2-Type-system-characteristics"><a href="#2-2-Type-system-characteristics" class="headerlink" title="2.2  Type system characteristics"></a>2.2  Type system characteristics</h3><p>现在被称为的强/弱、安全/不安全、静态/动态语言的特征</p>
<h4 id="2-2-1-C-’s-place-in-the-world-of-type-systems"><a href="#2-2-1-C-’s-place-in-the-world-of-type-systems" class="headerlink" title="2.2.1 C#’s place in the world of type systems"></a>2.2.1 C#’s place in the world of type systems</h4><p> <strong>C# 1’s type system is static ,explicit and safe.</strong></p>
<p>很多书和文章将C#描述成强类型的语言，实际都是指它是一种静态类型的语言</p>
<h5 id="STATIC-TYPING-VERSUS-DYNAMIC-TYPING"><a href="#STATIC-TYPING-VERSUS-DYNAMIC-TYPING" class="headerlink" title="STATIC TYPING VERSUS DYNAMIC TYPING"></a>STATIC TYPING VERSUS DYNAMIC TYPING</h5><p>看这个强制生效的例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">object o =&quot;hello&quot;;</span><br><span class="line">Console.WriteLine(o.Length);</span><br><span class="line">object o =&quot;hello&quot;;</span><br><span class="line">Console.WriteLine(((String)o).Length);</span><br></pre></td></tr></table></figure>
<p>可以说o的静态类型为System.Object.</p>
<p>动态类型的实质是变量中含有值，但是那些值并不限于特定的类型，所以编译器不能执行相同形式的检查。</p>
<p>对一个动态语言 可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">o=&quot;hello&quot;;</span><br><span class="line">Console.WriteLine(o.Length);</span><br><span class="line">o= new string[]&#123;&quot;hi&quot;,&quot;there&quot;&#125;;</span><br><span class="line">Console.WriteLine(o.Length);</span><br></pre></td></tr></table></figure>
<h5 id="EXPLICIT-TYPING-VERSUS-IMPLICIT-TYPING"><a href="#EXPLICIT-TYPING-VERSUS-IMPLICIT-TYPING" class="headerlink" title="EXPLICIT TYPING VERSUS IMPLICIT TYPING"></a>EXPLICIT TYPING VERSUS IMPLICIT TYPING</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var s=&quot;hello&quot;</span><br><span class="line">var x=s.Length;</span><br><span class="line">var twiceX=x*2;</span><br></pre></td></tr></table></figure>
<p>这在C#1中是不行的</p>
<h5 id="TYPE-SAFE-VERSUS-TYPE-UNSAFE"><a href="#TYPE-SAFE-VERSUS-TYPE-UNSAFE" class="headerlink" title="TYPE-SAFE VERSUS TYPE-UNSAFE"></a>TYPE-SAFE VERSUS TYPE-UNSAFE</h5><p>C 例子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>**argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *first_arg= argv[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> *first_arg_as_int =(<span class="keyword">int</span> *)first_arg;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,*first_arg_as_int);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-2-When-is-C-1’s-type-ststem-not-rich-enough"><a href="#2-2-2-When-is-C-1’s-type-ststem-not-rich-enough" class="headerlink" title="2.2.2 When is C# 1’s type ststem not rich enough?"></a>2.2.2 When is C# 1’s type ststem not rich enough?</h4><p>?:skier:</p>
<ol>
<li>集合，强和弱</li>
<li>缺乏协变的返回类型</li>
</ol>
<h4 id="2-2-3-Summary-of-type-system-characteristics"><a href="#2-2-3-Summary-of-type-system-characteristics" class="headerlink" title="2.2.3 Summary of type system characteristics"></a>2.2.3 Summary of type system characteristics</h4><ul>
<li>C#1 是静态类型的–编译器知道你能使用哪些成员</li>
<li>C#1 是显式的–必须告诉编译器变量具有什么 类型</li>
<li>C#1 是安全的–除非存在真实的转换关系，否则不能将一种类型当作另外一种类型</li>
<li>静态类型仍然不允许一个集合称为强类型的 字符串列表 或者 整数列表  除非针对不同的元素使用大量的重复代码</li>
<li>方法覆盖和接口实现不允许协变性和逆变性</li>
</ul>
<h2 id="2-3-Value-types-and-reference-types"><a href="#2-3-Value-types-and-reference-types" class="headerlink" title="2.3 Value types and reference types"></a>2.3 Value types and reference types</h2><h4 id="2-3-1-Values-and-references-in-the-real-world"><a href="#2-3-1-Values-and-references-in-the-real-world" class="headerlink" title="2.3.1 Values and references in the real world"></a>2.3.1 Values and references in the real world</h4><p>读报纸和读网页，对应的值类型和引用类型的区别</p>
<p>类是引用类型  而结构是值类型</p>
<p>特殊情况：</p>
<ul>
<li>数组类型是引用类型</li>
<li>枚举是值类型</li>
<li>委托类型是引用类型</li>
<li>接口类型是引用类型</li>
</ul>
<h4 id="2-3-2-Value-and-reference-type-fundamentals"><a href="#2-3-2-Value-and-reference-type-fundamentals" class="headerlink" title="2.3.2 Value and reference type fundamentals"></a>2.3.2 Value and reference type fundamentals</h4><p>变量的值在它声明时的位置存储。局部变量的值总是存储在栈中stack。实例变量的值总是存储在实例本身存储的地方。引用类型实例（对象）总是存储在堆中heap，静态变量也是</p>
<h4 id="2-3-3-Dispelling-myths"><a href="#2-3-3-Dispelling-myths" class="headerlink" title="2.3.3 Dispelling myths"></a>2.3.3 Dispelling myths</h4><p>误区1：“结构是轻量级的类”</p>
<h4 id="2-3-4-Boxing-and-unboxing"><a href="#2-3-4-Boxing-and-unboxing" class="headerlink" title="2.3.4 Boxing and unboxing"></a>2.3.4 Boxing and unboxing</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int i=5;</span><br><span class="line">object o =i;</span><br><span class="line">int j =(int)o;</span><br></pre></td></tr></table></figure>
<p>第二句装箱 第三局拆箱</p>
<p>装拆都不会改变原始值</p>
<p>将值作为接口表达式时也会装箱</p>
<p><code>IComparable x=5;</code></p>
<h4 id="2-3-5-值类型和引用类型小结"><a href="#2-3-5-值类型和引用类型小结" class="headerlink" title="2.3.5 值类型和引用类型小结"></a>2.3.5 值类型和引用类型小结</h4><ul>
<li>对于引用类型的表达式，它的值是一个引用，而非对象</li>
<li>引用就像URL-是允许你访问真实信息的一小片数据</li>
<li>对于值类型的表达式，他的值就是实际的数据</li>
<li>有时，值类型比引用类型更有效，有时恰好相反</li>
<li>引用类型的对象总是在堆上，值类型的值既可能在堆上 也可能在栈上</li>
<li>引用类型作为方法参数使用时，参数默认是以值传递 方式来传递的–但值本身是一个引用</li>
<li>值类型的值会在需要引用类型的行为时被装箱；拆箱是相反的过程。</li>
</ul>
<h3 id="2-4-C-1之外-构建于坚实基础之上的新特性"><a href="#2-4-C-1之外-构建于坚实基础之上的新特性" class="headerlink" title="2.4 C#1之外:构建于坚实基础之上的新特性"></a>2.4 C#1之外:构建于坚实基础之上的新特性</h3><h4 id="2-4-1-与委托有关的特性"><a href="#2-4-1-与委托有关的特性" class="headerlink" title="2.4.1 与委托有关的特性"></a>2.4.1 与委托有关的特性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">static void HandleDemoEvent(object sender,EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    System.Console.WriteLine(&quot;Handled by HandleDemoEvent&quot;);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">EventHandler handler;</span><br><span class="line">handler = new EventHandler(HandleDemoEvent);</span><br><span class="line">handler(null, EventArgs.Empty);</span><br><span class="line"></span><br><span class="line">handler= HandleDemoEvent;</span><br><span class="line">    handler(null, EventArgs.Empty);</span><br><span class="line">handler = delegate(object sender,EventArgs e)</span><br><span class="line">    &#123;</span><br><span class="line">    Console.WriteLine(&quot;Handled anonymously:&quot;);</span><br><span class="line">&#125;;</span><br><span class="line">handler(null,EventArgs.Empty);</span><br><span class="line">handler=delegate</span><br><span class="line">&#123;</span><br><span class="line">	Console.WriteLine(&quot;handled anonymously again&quot;);</span><br><span class="line">&#125;;</span><br><span class="line">handler(null,EventArgs.Empty);</span><br><span class="line">MouseEventHandler mouseHandler = HandleDemoEvent;</span><br><span class="line">mouseHandler(null,new MouseEventArgs(MouseButtons.None,0,0,0,0));</span><br></pre></td></tr></table></figure>
<p>Lambda表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;int ,int,string &gt; func =(x,y)=&gt;(x*y).ToString();</span><br><span class="line">Console.WriteLine(func(5,20));</span><br></pre></td></tr></table></figure>
<p>###2.4.2 Features related to the type system</p>
<p>匿名类型和隐式类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var jon = new &#123;Name =&quot;Jon&quot;,Age = 31&#125;;</span><br><span class="line">var tom = new &#123;Name =&quot;Tom&quot;,Age =4&#125;;</span><br><span class="line">Console.WriteLine(&quot;&#123;0&#125; is &#123;1&#125;&quot;,jon.Name,jon.Age);</span><br><span class="line">Console.WriteLine(&quot;&#123;0&#125; is &#123;1&#125;&quot;,tom.Name,tom.Age);</span><br></pre></td></tr></table></figure>
<p>C#4中的动态类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dynamic o =&quot;hello&quot;;</span><br><span class="line">Console.WriteLine(o.Length);</span><br><span class="line">o = new String[] &#123;&quot;hi&quot;,&quot;there&quot;&#125;;</span><br><span class="line">Console.WriteLine(o.Length);</span><br></pre></td></tr></table></figure>
<h4 id="2-4-2-Features-related-to-value-types"><a href="#2-4-2-Features-related-to-value-types" class="headerlink" title="2.4.2 Features related to value types"></a>2.4.2 Features related to value types</h4><ul>
<li>泛型</li>
<li>可空类型</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int? x= null;</span><br><span class="line">x =  5;</span><br><span class="line">if(x!=null)</span><br><span class="line">&#123;</span><br><span class="line">	int y = x.value;</span><br><span class="line">	Console.WriteLine(y);</span><br><span class="line">&#125;</span><br><span class="line">int z = x??10;</span><br></pre></td></tr></table></figure>
<p>###2.5 Summary </p>
<h2 id="3-Parameterized-typing-with-generics"><a href="#3-Parameterized-typing-with-generics" class="headerlink" title="3  Parameterized typing with generics"></a>3  Parameterized typing with generics</h2><h3 id="3-1-why-generics-are-necessary"><a href="#3-1-why-generics-are-necessary" class="headerlink" title="3.1 why generics are necessary"></a>3.1 why generics are necessary</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">static Dictionary&lt;string,int&gt; CountWords(string text)</span><br><span class="line">&#123;</span><br><span class="line">	Dictionary&lt;string,int&gt; frequencies;</span><br><span class="line">	frequencies = new Dictionary&lt;string,int&gt;();</span><br><span class="line">	string[] words = Regex.Split(text,@&quot;\W+&quot;);</span><br><span class="line">	foreach(string word in words)</span><br><span class="line">	&#123;</span><br><span class="line">		if(frequencies.ContainsKey(word))</span><br><span class="line">		&#123;</span><br><span class="line">			frequencies[word]++;</span><br><span class="line">		&#125;</span><br><span class="line">		else</span><br><span class="line">			frequencies[word]=1;</span><br><span class="line">	&#125;</span><br><span class="line">	return frequencies;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">string text = @&quot;Do you like green eggs and ham?</span><br><span class="line">				I do not like them,Sam-I-am.</span><br><span class="line">				I do not like green eggs and ham.&quot;;</span><br><span class="line">Dictionary&lt;string ,int&gt; frequencies= CountWords(text);</span><br><span class="line">foreach(KeyValuePair&lt;string,int&gt; entry in frequencies)</span><br><span class="line">&#123;</span><br><span class="line">	string word = entry.Key;</span><br><span class="line">	int frequency = entry.Value;</span><br><span class="line">	Console.WriteLine (&quot;&#123;0&#125;:&#123;1&#125;&quot;,word,frequency);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-2-2-Generic-types-and-type-parameters"><a href="#3-2-2-Generic-types-and-type-parameters" class="headerlink" title="3.2.2  Generic types and type parameters"></a>3.2.2  Generic types and type parameters</h4><p>泛型有两种形式: 泛型类型和泛型方法,两者都是表示API的基本方法.</p>
<p>类型参数是真实类型的占位符,真实的类型来替代他们,称为类型实参.</p>
<table>
<thead>
<tr>
<th>泛型类型中的方法签名</th>
<th>类型参数被替换之后的方法签名</th>
</tr>
</thead>
<tbody>
<tr>
<td>void Add(TKey key,TValue value)</td>
<td>void Add(string Key,int value)</td>
</tr>
<tr>
<td>TValue this[TKey key]{get;set;}</td>
<td>int this[string key]{get;set;}</td>
</tr>
<tr>
<td>bool ContainsValue(TValue value)</td>
<td>bool ContainsValue(int value)</td>
</tr>
<tr>
<td>bool ContainsKey(TKey key)</td>
<td>bool ContainsKey(string key)</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h4 id="3-2-3-Generic-methods-and-reading-generic-declarations"><a href="#3-2-3-Generic-methods-and-reading-generic-declarations" class="headerlink" title="3.2.3 Generic methods and reading generic declarations"></a>3.2.3 Generic methods and reading generic declarations</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">static double TakeSquareRoot(int x)</span><br><span class="line">&#123;</span><br><span class="line">	return Math.Sqrt(x);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">List&lt;int&gt; integers = new List&lt;int&gt;();</span><br><span class="line">integers.Add(1);</span><br><span class="line">integers.Add(2);</span><br><span class="line">integers.Add(3);</span><br><span class="line">integers.Add(4);</span><br><span class="line">Converter&lt;int,double&gt; converter = TakeSquareRoot;</span><br><span class="line">List&lt;double&gt; doubles;</span><br><span class="line">doubles = integers.ConvertAll&lt;double&gt;(converter);</span><br><span class="line">foreach(double d in doubles)</span><br><span class="line">&#123;</span><br><span class="line">	Console.WriteLine(d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Listing 3.3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">static List&lt;T&gt; MakeList&lt;T&gt; (T first,T second)</span><br><span class="line">&#123;</span><br><span class="line">	List&lt;T&gt; list = new List&lt;T&gt;();</span><br><span class="line">	list.Add(first);</span><br><span class="line">	list.Add(second);</span><br><span class="line">	return list;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">List&lt;string&gt; list = MakeList&lt;string&gt;(&quot;Line 1&quot;,&quot;Line 2&quot;);</span><br><span class="line">foreach(string x in list)</span><br><span class="line">&#123;</span><br><span class="line">	Console.WriteLine(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###3.3 Beyond the basics </p>
<ul>
<li>type constraints</li>
<li>type inference</li>
</ul>
<h4 id="3-3-1-Type-constraints"><a href="#3-3-1-Type-constraints" class="headerlink" title="3.3.1 Type constraints"></a>3.3.1 Type constraints</h4><p><strong>REFERENCE TYPE CONSTRAINT</strong></p>
<p><code>struct RefSample&lt;T&gt; where T: class</code></p>
<p>Valid closed types using this declaration include</p>
<ul>
<li><code>RefSample&lt;IDisposable&gt;</code></li>
<li><code>RefSample&lt;string&gt;</code></li>
<li><code>RefSample&lt;int[]&gt;</code></li>
</ul>
<p>Invalid closed types include</p>
<ul>
<li><code>RefSample&lt;Guid&gt;</code></li>
<li><code>RefSample&lt;int&gt;</code></li>
</ul>
<p><strong>VALUE TYPE CONSTRAINTS</strong></p>
<p><code>class ValSample&lt;T&gt; where T:struct</code></p>
<p>Valid closed types include</p>
<ul>
<li><code>ValSample&lt;int&gt;</code></li>
<li><code>ValSample&lt;FileMode&gt;</code></li>
</ul>
<p>Invalid closed types include</p>
<ul>
<li><code>ValSample&lt;object&gt;</code></li>
<li><code>ValSample&lt;StringBuilder&gt;</code></li>
</ul>
<p><strong>CONSTRUCTOR TYPE CONSTRAINTS</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public T CreateInstance&lt;T&gt;() where T: new()</span><br><span class="line">&#123;</span><br><span class="line">    return new T();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Valid : <code>CreateInstance&lt;int&gt;()</code> <code>CreateInstance&lt;object&gt;</code></p>
<p><strong>CONVERSION TYPE CONSTRAINTS</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class Sample&lt;T&gt; where T: Stream,</span><br><span class="line">						IEnumerable&lt;string&gt;,</span><br><span class="line">						IComparable&lt;int&gt;</span><br></pre></td></tr></table></figure>
<p>可以指定多个接口,但是只能指定一个类.</p>
<p><strong>COMBINING CONSTRAINTS</strong></p>
<p>Valid:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class Sample&lt;T&gt; where T:class,IDisposable,new()</span><br><span class="line">class Sample&lt;T&gt; where T:struct,IDisposable</span><br><span class="line">class Sample&lt;T,U&gt; where T: class where U:struct,T</span><br><span class="line">class Sample&lt;T,U&gt; where T: Stream where U:IDisposable</span><br></pre></td></tr></table></figure>
<p>Invalid:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class Sample&lt;T&gt; where T:class,struct</span><br><span class="line">    class Sample&lt;T&gt; where T: Stream,class</span><br><span class="line">        class Sample&lt;T,U&gt; where T:Stream,U:IDisposable</span><br></pre></td></tr></table></figure>
<h4 id="3-3-2-Type-inference-for-type-arguments-of-generic-methods"><a href="#3-3-2-Type-inference-for-type-arguments-of-generic-methods" class="headerlink" title="3.3.2 Type inference for type arguments of generic methods"></a>3.3.2 Type inference for type arguments of generic methods</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">static List&lt;T&gt; MakeList&lt;T&gt;(T first,T second)</span><br><span class="line">    ...</span><br><span class="line">List&lt;string&gt; list = MakeList&lt;string&gt;(&quot;Line 1&quot;,&quot;Line2&quot;);</span><br><span class="line">//we can write</span><br><span class="line">List&lt;string&gt; list = MakeList(&quot;Line 1&quot;,&quot;Line 2&quot;);</span><br></pre></td></tr></table></figure>
<h4 id="3-3-3-Implementing-generics"><a href="#3-3-3-Implementing-generics" class="headerlink" title="3.3.3 Implementing generics"></a>3.3.3 Implementing generics</h4><p><strong>DEFAULT VALUE EXPRESSIONS</strong></p>
<blockquote>
<p>listing 3.4 Comparing a given value to the default in a generic way</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">static int CompareToDefault&lt;T&gt; (T value) where T:IComparable&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line">	return value.CompareTo(default(T));</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">Console.WriteLine(CompareToDefault(&quot;x&quot;));</span><br><span class="line">Console.WriteLine(CompareToDefault(10));</span><br><span class="line">Console.WriteLine(CompareToDefault(0));</span><br><span class="line">Console.WriteLine(CompareToDefault(-10));</span><br><span class="line">Console.WriteLine(CompareToDefault(DateTime.MinValue));</span><br></pre></td></tr></table></figure>
<p><strong>DIRECT COMPARISONS</strong></p>
<p>when a type parameter is unconstrained , you can use the == and != operators,but ony to compare a value of that type with null; you cant compare two values of type T with each other.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">static bool AreReferencesEqual&lt;T&gt;(T first ,T second) </span><br><span class="line">	where T: class</span><br><span class="line">	&#123;</span><br><span class="line">		return first == second;</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br><span class="line">string name =&quot;Jon&quot;;</span><br><span class="line">string intro1 = &quot;my name is &quot;+ name;</span><br><span class="line">string intro2 = &quot;my name is &quot;+ name;</span><br><span class="line">Console.WriteLine(intro1==intro2);</span><br><span class="line">Console.WriteLine(AreReferencesEqual(intro1,intro2));</span><br></pre></td></tr></table></figure>
<p><strong>FULL COMPARISON EXAMPLE:REPRESENTING A PAIR OF VALUES</strong></p>
<blockquote>
<p>Listing 3.6 Generic class representing a pair of values</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line"></span><br><span class="line">namespace ConsoleApp1</span><br><span class="line">&#123;</span><br><span class="line">    public sealed class Pair&lt;T1,T2&gt;:IEquatable&lt;Pair&lt;T1,T2&gt;&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        private static readonly IEqualityComparer&lt;T1&gt; FirstComparer =</span><br><span class="line">            EqualityComparer&lt;T1&gt;.Default;</span><br><span class="line">        private static readonly IEqualityComparer&lt;T2&gt; SecondComparer =</span><br><span class="line">            EqualityComparer&lt;T2&gt;.Default;</span><br><span class="line">        private readonly T1 first;</span><br><span class="line">        private readonly T2 second;</span><br><span class="line">        public Pair(T1 first ,T2 second)</span><br><span class="line">        &#123;</span><br><span class="line">            this.first = first;</span><br><span class="line">            this.second = second;</span><br><span class="line">        &#125;</span><br><span class="line">        public T1 First &#123; get &#123; return first; &#125; &#125;</span><br><span class="line">        public T2 Second &#123; get &#123; return second; &#125; &#125;</span><br><span class="line">        public bool Equals(Pair&lt;T1,T2&gt; other)</span><br><span class="line">        &#123;</span><br><span class="line">            return other != null &amp;&amp;</span><br><span class="line">                FirstComparer.Equals(this.First, other.First) &amp;&amp;</span><br><span class="line">                SecondComparer.Equals(this.Second, other.Second);</span><br><span class="line">        &#125;</span><br><span class="line">        public override bool Equals(object obj)</span><br><span class="line">        &#123;</span><br><span class="line">            return Equals(obj as Pair&lt;T1,T2&gt;);</span><br><span class="line">        &#125;</span><br><span class="line">        public override int GetHashCode()</span><br><span class="line">        &#123;</span><br><span class="line">            return FirstComparer.GetHashCode(first) * 37 +</span><br><span class="line">                SecondComparer.GetHashCode(second);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class Pair</span><br><span class="line">    &#123;</span><br><span class="line">        public static Pair&lt;T1,T2&gt; Of&lt;T1,T2&gt;(T1 first ,T2 second)</span><br><span class="line">        &#123;</span><br><span class="line">            return new Pair&lt;T1, T2&gt;(first, second);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class Program</span><br><span class="line">    &#123;</span><br><span class="line">        static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">            Pair&lt;int, string&gt; pair = new Pair&lt;int, string&gt;(10, &quot;value&quot;);</span><br><span class="line">            Pair&lt;int, string&gt; pair1 = Pair.Of(10, &quot;value&quot;);</span><br><span class="line">            Console.WriteLine(pair.First);</span><br><span class="line">            Console.WriteLine(pair.Second);</span><br><span class="line">            Console.WriteLine(pair1.First);</span><br><span class="line">            Console.WriteLine(pair1.Second);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-4-Advanced-generics"><a href="#3-4-Advanced-generics" class="headerlink" title="3.4 Advanced generics"></a>3.4 Advanced generics</h3><h4 id="3-4-1-Static-fields-and-static-constructors"><a href="#3-4-1-Static-fields-and-static-constructors" class="headerlink" title="3.4.1 Static fields and static constructors"></a>3.4.1 Static fields and static constructors</h4><blockquote>
<p>Listing 3.8 Proof that different closed type s have different static fields</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class TypeWithField&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line">	public static string field;</span><br><span class="line">	public static void PrintField()</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(field+&quot;:&quot;+typeof(T).Name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">TypeWithField&lt;int&gt;.field =&quot;First&quot;;</span><br><span class="line">TypeWithField&lt;string&gt;.field =&quot;second&quot;;</span><br><span class="line">TypeWithField&lt;DateTime&gt;.field =&quot;Third&quot;;</span><br><span class="line">TypeWithField&lt;int&gt;.PrintField();</span><br><span class="line">TypeWithField&lt;string&gt;.PrintField();</span><br><span class="line">TypeWithField&lt;DateTime&gt;.PrintField();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Listing 3.9 Static constructors with nested generic types</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public class Outer&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line">	public class Inner&lt;U,V&gt;</span><br><span class="line">	&#123;</span><br><span class="line">		static Inner()</span><br><span class="line">		&#123;</span><br><span class="line">			Console.WriteLine(&quot;Outer&lt;&#123;0&#125;&gt;.Inner&lt;&#123;1&#125;,&#123;2&#125;&gt;&quot;,</span><br><span class="line">							typeof(T).Name,</span><br><span class="line">							typeof(U).Name,</span><br><span class="line">							typeof(V).Name</span><br><span class="line">							);</span><br><span class="line">		&#125;</span><br><span class="line">		public static void DummyMethod()&#123;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">Outer&lt;int&gt;.Inner&lt;string,DateTime&gt;.DummyMethod();</span><br><span class="line">Outer&lt;string&gt;.Inner&lt;int,int&gt;.DummyMethod();</span><br><span class="line">Outer&lt;object&gt;.Inner&lt;string,object&gt;.DummyMethod();</span><br><span class="line">Outer&lt;string&gt;.Inner&lt;string,object&gt;.DummyMethod();</span><br><span class="line">Outer&lt;object&gt;.Inner&lt;object,string&gt;.DummyMethod();</span><br><span class="line">Outer&lt;string&gt;.Inner&lt;int,int&gt;.DummyMethod();</span><br></pre></td></tr></table></figure>
<h4 id="3-4-2-How-the-JIT-compiler-handles-generics"><a href="#3-4-2-How-the-JIT-compiler-handles-generics" class="headerlink" title="3.4.2 How the JIT compiler handles generics"></a>3.4.2 How the JIT compiler handles generics</h4><h4 id="3-4-3-Generic-iteration"><a href="#3-4-3-Generic-iteration" class="headerlink" title="3.4.3 Generic iteration"></a>3.4.3 Generic iteration</h4><blockquote>
<p>listing 3.10 A full generic iterator - of the numbers 0 to 9</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">class CountingEnumerable:IEnumerable&lt;int&gt;</span><br><span class="line">&#123;</span><br><span class="line">	public IEnumerator&lt;int&gt; GetEnumerator()</span><br><span class="line">	&#123;</span><br><span class="line">		return new CountingEnumerator();</span><br><span class="line">	&#125;</span><br><span class="line">	IEnumerator IEnumerable.GetEnumerator()</span><br><span class="line">	&#123;</span><br><span class="line">		return GetEnumerator();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">class CountingEnumerator:IEnumerator&lt;int&gt;</span><br><span class="line">&#123;</span><br><span class="line">	int current =-1;</span><br><span class="line">	public bool MoveNext()</span><br><span class="line">	&#123;</span><br><span class="line">		current++;</span><br><span class="line">		return current&lt;10;</span><br><span class="line">	&#125;</span><br><span class="line">	public int Current&#123;get&#123;return current;&#125;&#125;</span><br><span class="line">	object IEnumerator.Current&#123;get&#123;return Current;&#125;&#125;</span><br><span class="line">	public void Reset()</span><br><span class="line">	&#123;</span><br><span class="line">		current =-1;</span><br><span class="line">	&#125;</span><br><span class="line">	public void Dispose()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">CountingEnumerable counter = new CountingEnumerable();</span><br><span class="line">foreach(int x in counter)</span><br><span class="line">&#123;</span><br><span class="line">	Console.WriteLine(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-4-4-Reflection-and-generics"><a href="#3-4-4-Reflection-and-generics" class="headerlink" title="3.4.4 Reflection and generics"></a>3.4.4 Reflection and generics</h4><p><strong>USING TYPEOF WITH GENERIC TYPES</strong></p>
<blockquote>
<p>listing 3.11</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">static void DemonstrateTypeof&lt;X&gt;()</span><br><span class="line">&#123;</span><br><span class="line">	Console.WriteLine(typeof(X));</span><br><span class="line">	Console.WriteLine(typeof(List&lt;&gt;));</span><br><span class="line">	Console.WriteLine(typeof(Dictionary&lt;,&gt;));</span><br><span class="line">	Console.WriteLine(typeof(List&lt;X&gt;));</span><br><span class="line">	Console.WriteLine(typeof(Dictionary&lt;string,X&gt;));</span><br><span class="line">	Console.WriteLine(typeof(List&lt;long&gt;));</span><br><span class="line">	Console.WriteLine(typeof(Dictionary&lt;long,Guid&gt;));</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">DemonstrateTypeof&lt;int&gt;();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>listing 3.12</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string listTypeName=&quot;System.Collections.Generic.List`1&quot;;</span><br><span class="line">Type defByName =Type.GetType(listTypeName);</span><br><span class="line">Type closedByName = Type.GetType(listTypeName+&quot;[System.String]&quot;);</span><br><span class="line">Type closedByMethod = defByName.MakeGenericType(typeof(string));</span><br><span class="line">Type closedByTypeof = typeof(List&lt;string&gt;);</span><br><span class="line">Console.WriteLine (closedByMethod == closedByName);</span><br><span class="line">Console.WriteLine(closedByName==closedByTypeof);</span><br><span class="line"></span><br><span class="line">Type defByTypeof= typeof(List&lt;&gt;);</span><br><span class="line">Type defByMethod = closedByName.GetGenericTypeDefinition();</span><br><span class="line">Console.WriteLine(defByMethod==defByName);</span><br><span class="line">Console.WriteLine(defByName==defByTypeof);</span><br></pre></td></tr></table></figure>
<p>System.Type的属性和方法</p>
<p>有两个方法是最重要的GetGenericTypeDefinition和MakeGenericType(作用于泛型类型定义,返回一个已构造类型)</p>
<ol start="3">
<li>反射泛型方法</li>
</ol>
<p>通过反射来调用泛型方法</p>
<blockquote>
<p>Listing 3.13</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public static void PrintTypeParameter&lt;T&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(typeof(T));</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">Type type = typeof(Snippet);</span><br><span class="line">MethodInfo definition = type.GetMethod(&quot;PrintTypeParameter&quot;);</span><br><span class="line">MethodInfo constructed = definition.MakeGenericMethod(typeof(string));</span><br><span class="line">constructed.Invoke(null,null);</span><br></pre></td></tr></table></figure>
<h3 id="3-5-Limitations-of-generics-in-C-and-other-languages"><a href="#3-5-Limitations-of-generics-in-C-and-other-languages" class="headerlink" title="3.5 Limitations of generics in C# and other languages"></a>3.5 Limitations of generics in C# and other languages</h3><h4 id="3-5-1-Lack-of-generic-variance"><a href="#3-5-1-Lack-of-generic-variance" class="headerlink" title="3.5.1 Lack of generic variance"></a>3.5.1 Lack of generic variance</h4><p>泛型是不变体</p>
<ol start="2">
<li>协变性在什么时候有用</li>
<li>没理解</li>
</ol>
<p>####3.5.4 comparison with C++ templates</p>
<h2 id="4-Saying-nothing-with-nullable-types"><a href="#4-Saying-nothing-with-nullable-types" class="headerlink" title="4 Saying nothing with nullable types"></a>4 Saying nothing with nullable types</h2><h3 id="4-1-What-do-you-do-when-you-just-dont-have-a-value"><a href="#4-1-What-do-you-do-when-you-just-dont-have-a-value" class="headerlink" title="4.1 What do you do when you  just dont have a value?"></a>4.1 What do you do when you  just dont have a value?</h3><h4 id="4-1-1-Why-value-type-variables-cant-be-null"><a href="#4-1-1-Why-value-type-variables-cant-be-null" class="headerlink" title="4.1.1 Why value type variables cant be null"></a>4.1.1 Why value type variables cant be null</h4><h4 id="4-1-2-Patterns-for-representing-null-values-in-C-1"><a href="#4-1-2-Patterns-for-representing-null-values-in-C-1" class="headerlink" title="4.1.2 Patterns for representing null values in C#1"></a>4.1.2 Patterns for representing null values in C#1</h4><h3 id="4-2-System-Nullable-lt-T-gt-and-System-Nullable"><a href="#4-2-System-Nullable-lt-T-gt-and-System-Nullable" class="headerlink" title="4.2 System.Nullable &lt;T&gt;and System.Nullable"></a>4.2 System.Nullable <code>&lt;T&gt;</code>and System.Nullable</h3><h4 id="4-2-1-Introduciong-Nullable-lt-T-gt"><a href="#4-2-1-Introduciong-Nullable-lt-T-gt" class="headerlink" title="4.2.1 Introduciong Nullable&lt;T&gt;"></a>4.2.1 Introduciong Nullable<code>&lt;T&gt;</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">static void Display(Nullable&lt;int&gt; x)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;HasValue: &#123;0&#125;&quot;,x.HasValue);</span><br><span class="line">            if (x.HasValue)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(&quot;Value: &#123;0&#125;&quot;,x.Value);</span><br><span class="line">                Console.WriteLine(&quot;Explicit conversion: &#123;0&#125; &quot;,(int)x);</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(&quot;GetValueOrDefault(): &#123;0&#125;&quot;,x.GetValueOrDefault());</span><br><span class="line">            Console.WriteLine(&quot;GetValueOrDefault(10) : &#123;0&#125;&quot;,x.GetValueOrDefault(10));</span><br><span class="line">            Console.WriteLine(&quot;ToString(*): \&quot;&#123;0&#125;\&quot;&quot;,x.ToString());</span><br><span class="line">            Console.WriteLine(&quot;GetHashCode(): &#123;0&#125; &quot;,x.GetHashCode());</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">        &#125;</span><br><span class="line">...</span><br><span class="line">Nullable&lt;int&gt; x = 5;</span><br><span class="line">x = new Nullable&lt;int&gt;(5);</span><br><span class="line">Console.WriteLine(&quot;Instance with value: &quot;);</span><br><span class="line">Display(x);</span><br><span class="line">x= new Nullable&lt;int&gt;();</span><br><span class="line">Console.WriteLine(&quot;Instance without value:&quot;);</span><br><span class="line">Display(x);</span><br></pre></td></tr></table></figure>
<h4 id="4-2-2-Boxing-Nullable-lt-T-gt-and-unboxing"><a href="#4-2-2-Boxing-Nullable-lt-T-gt-and-unboxing" class="headerlink" title="4.2.2 Boxing Nullable&lt;T&gt; and unboxing"></a>4.2.2 Boxing Nullable<code>&lt;T&gt;</code> and unboxing</h4><p>It is  important to remember that Nullable<code>&lt;T&gt;</code> is a struct —a value type.</p>
<h4 id="4-2-3-Equality-of-Nullable-lt-T-gt-instances"><a href="#4-2-3-Equality-of-Nullable-lt-T-gt-instances" class="headerlink" title="4.2.3 Equality of Nullable&lt;T&gt; instances"></a>4.2.3 Equality of Nullable<code>&lt;T&gt;</code> instances</h4><h4 id="4-2-4-Support-from-the-nongeneric-Nullable-class"><a href="#4-2-4-Support-from-the-nongeneric-Nullable-class" class="headerlink" title="4.2.4 Support from the nongeneric Nullable class"></a>4.2.4 Support from the nongeneric Nullable class</h4><h3 id="4-3-C-2’s-syntactic-sugar-for-nullable-types"><a href="#4-3-C-2’s-syntactic-sugar-for-nullable-types" class="headerlink" title="4.3 C# 2’s syntactic sugar for nullable types"></a>4.3 C# 2’s syntactic sugar for nullable types</h3><h4 id="4-3-1-The-modifier"><a href="#4-3-1-The-modifier" class="headerlink" title="4.3.1 The ? modifier"></a>4.3.1 The ? modifier</h4><blockquote>
<p>list4.2 same as 4.1</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int? nullable = 5;</span><br><span class="line">object boxed = nullable;</span><br><span class="line">Console.WriteLine(boxed.GetType());</span><br><span class="line"></span><br><span class="line">int normal = (int)boxed;</span><br><span class="line">Console.WriteLine(normal);</span><br><span class="line"></span><br><span class="line">nullable = new int?();</span><br><span class="line">boxed = nullable;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(boxed==null);</span><br><span class="line"></span><br><span class="line">nullable = (int?)boxed;</span><br><span class="line">Console.WriteLine(nullable.HasValue);</span><br></pre></td></tr></table></figure>
<p> 强调一波 代码最终是要给人读的 所以可读性和规范化很重要</p>
<p>We’ll model a Person class where you need to know a person’s name,date of birth,and date of death.Some of those people may still be alive—in which case the date of death will be represented by null.Here is some code .</p>
<blockquote>
<p>Listing 4.4  Part of a Person class including calculation of age</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">public TimeSpan get_Age()</span><br><span class="line">&#123;</span><br><span class="line">    if (!this.death.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        return (TimeSpan) (DateTime.Now - this.birth);</span><br><span class="line">    &#125;</span><br><span class="line">    return (this.death.Value - this.birth);</span><br><span class="line">&#125;</span><br><span class="line">//这是IL</span><br><span class="line"> public class Person</span><br><span class="line">  &#123;</span><br><span class="line">      private DateTime  birth;</span><br><span class="line">      private DateTime? death;</span><br><span class="line">      private string name;</span><br><span class="line">      public TimeSpan Age</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                if (death == null)</span><br><span class="line">                &#123;</span><br><span class="line">                    return DateTime.Now - birth;</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    return death.Value - birth;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      public Person(string name, DateTime birth, DateTime? death)</span><br><span class="line">        &#123;</span><br><span class="line">            this.birth = birth;</span><br><span class="line">            this.death = death;</span><br><span class="line">            this.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br><span class="line">Person turing = new Person(&quot;Alan Turing&quot;, new DateTime(1912, 6, 23), new 	DateTime(1954, 4, 7));</span><br><span class="line">            Person knuth = new Person(&quot;Donald Knuth &quot;, new DateTime(1938, 1, 10), null);</span><br><span class="line">            Console.WriteLine(turing.Age);</span><br><span class="line">            Console.WriteLine(knuth.Age);</span><br></pre></td></tr></table></figure>
<h4 id="4-3-2-Assigning-and-comparing-with-null"><a href="#4-3-2-Assigning-and-comparing-with-null" class="headerlink" title="4.3.2 Assigning and comparing with null"></a>4.3.2 Assigning and comparing with null</h4><h4 id="4-3-3-Nullable-conversions-and-operators"><a href="#4-3-3-Nullable-conversions-and-operators" class="headerlink" title="4.3.3 Nullable conversions and operators"></a>4.3.3 Nullable conversions and operators</h4><pre><code>可空类型也是可以转换的
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int i=5;</span><br><span class="line">if(i==null)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(&quot;Never going to happen&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这玩意会发出警告,因为两者都存在一个到int?的隐式转换</p>
<h4 id="4-3-4-Nullable-logic"><a href="#4-3-4-Nullable-logic" class="headerlink" title="4.3.4 Nullable logic"></a>4.3.4 Nullable logic</h4><h4 id="4-3-5-Using-the-as-operator-with-nullable-types"><a href="#4-3-5-Using-the-as-operator-with-nullable-types" class="headerlink" title="4.3.5  Using the as operator with nullable types"></a>4.3.5  Using the as operator with nullable types</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">static void PrintValueAsInt32(object o)</span><br><span class="line">        &#123;</span><br><span class="line">            int? nullable = o as int?;</span><br><span class="line">            System.Console.WriteLine(nullable.HasValue? nullable.Value.ToString():&quot;null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">...</span><br><span class="line">			System.Console.WriteLine(&quot;null as:&quot;);</span><br><span class="line">            PrintValueAsInt32(5);</span><br><span class="line">            PrintValueAsInt32(&quot;some string&quot;);</span><br></pre></td></tr></table></figure>
<p>然而.net 4.5 以前is 和强制转换比 as快20倍</p>
<h4 id="4-3-6-The-null-coalescing-operator"><a href="#4-3-6-The-null-coalescing-operator" class="headerlink" title="4.3.6 The null coalescing operator"></a>4.3.6 The null coalescing operator</h4><p>空合并操作符 </p>
<p>这个二元操作符在对first??second求值时:</p>
<ol>
<li>对first进行求值</li>
<li>如果结果非空,则该结果就是整个表达式的结果</li>
<li>否则求second的值,其结果作为整个表达式的结果</li>
</ol>
<p>之前的死亡日期属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DateTime lastAlive = death??DateTime.Now</span><br><span class="line">return lastAlive-birth;</span><br></pre></td></tr></table></figure>
<p>涉及空值的时候就可以这么写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Address contact = user.COntractAddress;</span><br><span class="line">if(contact ==null)</span><br><span class="line">&#123;</span><br><span class="line">    contact = order.ShippingAddress;</span><br><span class="line">    if(contact ==null)</span><br><span class="line">    &#123;</span><br><span class="line">        contact = user.BillingAddress;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===&gt;</span><br><span class="line">Address contact = user.ContactAddress??</span><br><span class="line">    				order.ShippingAddress??</span><br><span class="line">    					user.BillingAddress;</span><br></pre></td></tr></table></figure>
<h3 id="4-4-Novel-uses-of-nullable-types"><a href="#4-4-Novel-uses-of-nullable-types" class="headerlink" title="4.4 Novel uses of nullable types"></a>4.4 Novel uses of nullable types</h3><h4 id="4-4-1-Tyeing-an-operation-without-using-output-parameter"><a href="#4-4-1-Tyeing-an-operation-without-using-output-parameter" class="headerlink" title="4.4.1 Tyeing an operation without using output parameter"></a>4.4.1 Tyeing an operation without using output parameter</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">static int? TryParse(string text)</span><br><span class="line">        &#123;</span><br><span class="line">            int ret;</span><br><span class="line">            if (int.TryParse(text, out ret))</span><br><span class="line">            &#123;</span><br><span class="line">                return ret;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">...</span><br><span class="line">			int? parsed = TryParse(&quot;No valid&quot;);//(可空调用)</span><br><span class="line">            if (parsed != null)</span><br><span class="line">            &#123;</span><br><span class="line">                System.Console.WriteLine(&quot;Parsed to &#123;0&#125;&quot;, parsed.Value);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                System.Console.WriteLine(&quot;Countnt parse&quot;);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>后面的方法更为条理清晰</p>
<p>####4.4.2 Painless comparisons with the null coalescing operator</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public int Compare(Product first, Product second)</span><br><span class="line">        &#123;</span><br><span class="line">            return PC.ReferenceCompare(first, second) ?? PC.Compare(second.Popularity, first.Popularity)</span><br><span class="line">                   ?? PC.Compare(first.Price, second.Price) ?? PC.Compare(first.Name, second.Name) ?? 0;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-5-Summary"><a href="#4-5-Summary" class="headerlink" title="4.5 Summary"></a>4.5 Summary</h3><p>Nullable types solves a specific problem that only has somewhat ugly solutions before C#2.The delegate enhancements in C#2 act as a bridge between the familiarity of C#1 and the style of idiomatic C#3,which can often be raidcally different from earlier versions.</p>
<h2 id="5-Fast-tracked-delegates"><a href="#5-Fast-tracked-delegates" class="headerlink" title="5 Fast-tracked delegates"></a>5 Fast-tracked delegates</h2><h3 id="5-1-Saying-goodbye-to-awkward-delegate-syntax"><a href="#5-1-Saying-goodbye-to-awkward-delegate-syntax" class="headerlink" title="5.1 Saying goodbye to awkward delegate syntax"></a>5.1 Saying goodbye to awkward delegate syntax</h3><blockquote>
<p>list5.1 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">static void LogPlainEvent(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;LogPlain&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static void LogKeyEvent(object sender, KeyPressEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;LogKey&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static void LogMouseEvent(object sender, MouseEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;LogMouse&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">...</span><br><span class="line">    Button button = new Button();</span><br><span class="line">          button.Text = &quot;Click me&quot;;</span><br><span class="line">          button.Click += new EventHandler(LogPlainEvent);</span><br><span class="line">          button.KeyPress += new KeyPressEventHandler(LogKeyEvent);</span><br><span class="line">          button.MouseClick += new MouseEventHandler(LogMouseEvent);</span><br><span class="line"></span><br><span class="line">          Form form = new Form();</span><br><span class="line">          form.AutoSize = true;</span><br><span class="line">          form.Controls.Add(button);</span><br><span class="line">          Application.Run(form);</span><br></pre></td></tr></table></figure>
<h3 id="5-2-Method-group-conversions"><a href="#5-2-Method-group-conversions" class="headerlink" title="5.2 Method group conversions"></a>5.2 Method group conversions</h3><h3 id="5-3-Covariance-and-contravariance"><a href="#5-3-Covariance-and-contravariance" class="headerlink" title="5.3 Covariance and contravariance"></a>5.3 Covariance and contravariance</h3><blockquote>
<p>list5.2</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Button button = new Button();</span><br><span class="line">          button.Text = &quot;Click me&quot;;</span><br><span class="line">          button.Click += LogPlainEvent;</span><br><span class="line">          button.KeyPress += LogPlainEvent;</span><br><span class="line">          button.MouseClick += LogPlainEvent;</span><br><span class="line"></span><br><span class="line">          Form form = new Form();</span><br><span class="line">          form.AutoSize = true;</span><br><span class="line">          form.Controls.Add(button);</span><br><span class="line">          Application.Run(form);</span><br><span class="line">static void LogPlainEvent(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;LogPlain&quot;);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-1-Contravariance-for-delegate-parameters"><a href="#5-3-1-Contravariance-for-delegate-parameters" class="headerlink" title="5.3.1 Contravariance for delegate parameters"></a>5.3.1 Contravariance for delegate parameters</h4><h4 id="5-3-2-Covariance-of-delegate-return-types"><a href="#5-3-2-Covariance-of-delegate-return-types" class="headerlink" title="5.3.2 Covariance of delegate return types"></a>5.3.2 Covariance of delegate return types</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">delegate Stream StreamFactory();</span><br><span class="line">static MemoryStream GenerateSampleData()</span><br><span class="line">&#123;</span><br><span class="line">	byte[] buffer = new byte[16];</span><br><span class="line">	for(int i=0;i&lt;buffer.Length;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		buffer[i]=(byte)i;</span><br><span class="line">	&#125;</span><br><span class="line">	return new MemoryStream(buffer);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">StreamFactory factory = GenerateSampleData;</span><br><span class="line">using(Stream stream = factory())</span><br><span class="line">&#123;</span><br><span class="line">	int data;</span><br><span class="line">	while((data=stream.ReadByte())!=-1)</span><br><span class="line">	&#123;</span><br><span class="line">		Console.WriteLine(data);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-3-A-small-risk-of-incompatibility"><a href="#5-3-3-A-small-risk-of-incompatibility" class="headerlink" title="5.3.3 A small risk of incompatibility"></a>5.3.3 A small risk of incompatibility</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">delegate void SampleDelegate(string x);</span><br><span class="line"></span><br><span class="line">        public void CandidateAction(string x)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;Snippet.CandidateAction&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public class Derived : Snippet</span><br><span class="line">        &#123;</span><br><span class="line">            public void CandidateAction(object o)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(&quot;Derived.CandidateAction&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">Derived x = new Derived();</span><br><span class="line">          SampleDelegate factory = new SampleDelegate(x.CandidateAction);</span><br><span class="line">          factory(&quot;test&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="5-4-Inline-delegate-actions-with-anonymous-methods"><a href="#5-4-Inline-delegate-actions-with-anonymous-methods" class="headerlink" title="5.4 Inline delegate actions with anonymous methods"></a>5.4 Inline delegate actions with anonymous methods</h3><h4 id="5-4-1-Starting-simply-acting-on-a-parameter"><a href="#5-4-1-Starting-simply-acting-on-a-parameter" class="headerlink" title="5.4.1 Starting simply : acting on a parameter"></a>5.4.1 Starting simply : acting on a parameter</h4><blockquote>
<p>list5.5</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Action&lt;string&gt; printReverse = delegate(string text)</span><br><span class="line">                &#123;</span><br><span class="line">                    char[] chars = text.ToCharArray();</span><br><span class="line">                    Array.Reverse(chars);</span><br><span class="line">                    Console.WriteLine(new string(chars));</span><br><span class="line">                &#125;;</span><br><span class="line">            Action&lt;int&gt; printRoot = delegate(int number) &#123; Console.WriteLine(Math.Sqrt(number)); &#125;;</span><br><span class="line">            Action&lt;IList&lt;double&gt;&gt; printMean = delegate(IList&lt;double&gt; numbers)</span><br><span class="line">                &#123;</span><br><span class="line">                    double total = 0;</span><br><span class="line">                    foreach (double value in numbers)</span><br><span class="line">                    &#123;</span><br><span class="line">                        total += value;</span><br><span class="line">                    &#125;</span><br><span class="line">                    Console.WriteLine(total / numbers.Count);</span><br><span class="line">                &#125;;</span><br><span class="line">            printReverse(&quot;Hello her&quot;);</span><br><span class="line">            printRoot(2);</span><br><span class="line">            printMean(new double[] &#123; 1.5, 2.5, 3, 4.5 &#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//三级跳</span><br><span class="line"> delegate int calculator(int x, int y); //委托类型</span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            calculator cal = new calculator(Adding);</span><br><span class="line">            int He = cal(1, 1);</span><br><span class="line">            Console.Write(He);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static int Adding(int x, int y)</span><br><span class="line">        &#123;</span><br><span class="line">            return x + y;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">delegate int calculator(int x, int y); //委托 匿名方法 其实就是省略了 委托的方法名称</span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            calculator cal = delegate(int num1,int num2)</span><br><span class="line">            &#123;</span><br><span class="line">                return num1 + num2;</span><br><span class="line">            &#125;;</span><br><span class="line">            int he = cal(1, 1);</span><br><span class="line">            Console.Write(he);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">delegate int calculator(int x, int y); //委托类型</span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            calculator cal = (x, y) =&gt; x + y;//Lambda表达式，大家发现没有，代码一个比一个简洁</span><br><span class="line">            int he = cal(1, 1);</span><br><span class="line">            Console.Write(he);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-4-2-Returing-values-from-anonymous-methods"><a href="#5-4-2-Returing-values-from-anonymous-methods" class="headerlink" title="5.4.2 Returing values from anonymous methods"></a>5.4.2 Returing values from anonymous methods</h4><blockquote>
<p>list 5.7</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;int&gt; isEven = delegate(int x) &#123; return x % 2 == 0; &#125;;</span><br><span class="line">            Console.WriteLine(isEven(1));</span><br></pre></td></tr></table></figure>
<p>​    新的语法和我们所期望的几乎完全相符__不需要在delegate那里声明返回类型.The compiler checks that all the possible return values are compatible with the declared return type of the delgate type it is trying to  convert the anonymous method into.</p>
<blockquote>
<p>list5.8</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SortAndShowFiles(</span><br><span class="line">                &quot;Sorted by name:&quot;,</span><br><span class="line">                delegate(FileInfo f1, FileInfo f2) &#123; return f1.Name.CompareTo(f2.Name); &#125;);</span><br><span class="line">            SortAndShowFiles(</span><br><span class="line">                &quot;Sorted by length: &quot;,</span><br><span class="line">                delegate(FileInfo f1, FileInfo f2) &#123; return f1.Length.CompareTo(f2.Length); &#125;);</span><br><span class="line">            SortAndShowFiles(&quot;Sorted by name lambda: &quot;,</span><br><span class="line">                (x, y) =&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        return x.Name.CompareTo(y.Name);</span><br><span class="line">                    &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="5-4-3-Ignoring-delegate-parameters"><a href="#5-4-3-Ignoring-delegate-parameters" class="headerlink" title="5.4.3 Ignoring delegate parameters"></a>5.4.3 Ignoring delegate parameters</h4><blockquote>
<p>list 5.6 代码精简</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">List&lt;int&gt; x = new List&lt;int&gt;();</span><br><span class="line">            x.Add(5);</span><br><span class="line">            x.Add(10);</span><br><span class="line">            x.Add(15);</span><br><span class="line">            x.Add(20);</span><br><span class="line">            x.Add(25);</span><br><span class="line">			x.ForEach(</span><br><span class="line">                delegate(int n)</span><br><span class="line">                    &#123;</span><br><span class="line">                        Console.WriteLine(Math.Sqrt(n));</span><br><span class="line">                    &#125;</span><br><span class="line">            );</span><br><span class="line">            x.ForEach(</span><br><span class="line">                (n) =&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        Console.WriteLine(Math.Sqrt(n));</span><br><span class="line">                    &#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>list 5.9 Subcribing to events with anonymous methods that ignore parameters</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Button button = new Button();</span><br><span class="line">            button.Text = &quot;Click me&quot;;</span><br><span class="line">            button.Click += delegate &#123; Console.WriteLine(&quot;LogPlain&quot;); &#125;;</span><br><span class="line">            button.KeyPress += delegate &#123; Console.WriteLine(&quot;LogKey&quot;); &#125;;</span><br><span class="line">            button.MouseClick += delegate &#123; Console.WriteLine(&quot;LogMouse&quot;); &#125;;</span><br><span class="line">            Form form = new Form();</span><br><span class="line">            form.AutoSize = true;</span><br><span class="line">            form.Controls.Add(button);</span><br><span class="line">            Application.Run(form);</span><br><span class="line"></span><br><span class="line">how about lambda</span><br></pre></td></tr></table></figure>
<h3 id="5-5-Capturing-variables-in-anonymous-methods"><a href="#5-5-Capturing-variables-in-anonymous-methods" class="headerlink" title="5.5 Capturing variables in anonymous methods"></a>5.5 Capturing variables in anonymous methods</h3><blockquote>
<p>list 5.10 Examples of variable kinds with respect to anonymous methods</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">static void EnclosingMethod()</span><br><span class="line">        &#123;</span><br><span class="line">            int outerVariable = 5;</span><br><span class="line">            string capturedVariable = &quot;captured&quot;;</span><br><span class="line">            if (DateTime.Now.Hour == 9)</span><br><span class="line">            &#123;</span><br><span class="line">                int normallLocalVariable = DateTime.Now.Minute;</span><br><span class="line">                Console.WriteLine(normallLocalVariable);</span><br><span class="line">            &#125;</span><br><span class="line">            MethodInvoker x = delegate()</span><br><span class="line">                &#123;</span><br><span class="line">                    string anonLocal = &quot;local to anonymous method&quot;;</span><br><span class="line">                    Console.WriteLine(capturedVariable+anonLocal);</span><br><span class="line">                &#125;;</span><br><span class="line">            x();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-5-1-Defining-closures-and-different-types-of-variables"><a href="#5-5-1-Defining-closures-and-different-types-of-variables" class="headerlink" title="5.5.1 Defining closures and different types of variables"></a>5.5.1 Defining closures and different types of variables</h4><h4 id="5-5-2-Examining-the-behavior-of-captured-variables"><a href="#5-5-2-Examining-the-behavior-of-captured-variables" class="headerlink" title="5.5.2 Examining the behavior of captured variables"></a>5.5.2 Examining the behavior of captured variables</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">string captured = &quot;Before x is captured&quot;;</span><br><span class="line">            MethodInvoker x = delegate</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(captured);</span><br><span class="line">                    captured = &quot;Changed by x&quot;;</span><br><span class="line">                &#125;;</span><br><span class="line">            captured = &quot;directly before x is invoked&quot;;</span><br><span class="line">            x();</span><br><span class="line">            Console.WriteLine(captured);</span><br><span class="line">            captured = &quot;before second invocation&quot;;</span><br><span class="line">            x();</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Person&gt; FindAllYoungerThan(List&lt;Person&gt; people,int limit)</span><br><span class="line">&#123;</span><br><span class="line">    return people.FindAll(delegate (Person person)</span><br><span class="line">                          &#123;</span><br><span class="line">                              return person.Age&lt;limit;</span><br><span class="line">                          &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-5-3-What’s-the-point-of-captured-variables"><a href="#5-5-3-What’s-the-point-of-captured-variables" class="headerlink" title="5.5.3 What’s the point of captured variables"></a>5.5.3 What’s the point of captured variables</h4><h4 id="5-5-4-The-extended-lifetime-of-captured-variables"><a href="#5-5-4-The-extended-lifetime-of-captured-variables" class="headerlink" title="5.5.4 The extended lifetime of  captured variables"></a>5.5.4 The extended lifetime of  captured variables</h4><blockquote>
<p>list5.12  Demonstration of a captured variabled variable having its lifetime extended</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">            MethodInvoker x = CreateDelegateInstance();</span><br><span class="line">            x();</span><br><span class="line">            x();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static MethodInvoker CreateDelegateInstance()</span><br><span class="line">        &#123;</span><br><span class="line">            int counter = 5;</span><br><span class="line">            MethodInvoker ret = delegate</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(counter);</span><br><span class="line">                    counter++;</span><br><span class="line">                &#125;;</span><br><span class="line">            ret();</span><br><span class="line">            return ret;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>A captured varibale lives for at least as long as any delegate instance referring to it.</p>
<p>我们一般会人为counter在栈上,实际上在堆上?</p>
<p>####5.5.5 Local vairable instantiations</p>
<p>比较这两段代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int single;</span><br><span class="line">for(int i =0;i&lt;10;i++)&#123;</span><br><span class="line">    single =5;</span><br><span class="line">    cw(single+i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//latter</span><br><span class="line">for(int i =0;i&lt;10;i++)</span><br><span class="line">&#123;</span><br><span class="line">    int multiple =5;</span><br><span class="line">    Cw(multiple+i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后者被创建了10次moultiple</p>
<blockquote>
<p>list5.13 capturing multiple variable instantiations with multiple delegates<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MethodInvoker&gt; list = new List&lt;MethodInvoker&gt;();</span><br><span class="line">            for (int index = 0; index &lt; 5; index++)</span><br><span class="line">            &#123;</span><br><span class="line">                int counter = index * 10; //实例化counter 多次 每次都是不同的变量</span><br><span class="line">                list.Add(</span><br><span class="line">                    delegate</span><br><span class="line">                        &#123;</span><br><span class="line">                            Console.WriteLine(counter);//打印并递增捕获的变量</span><br><span class="line">                            counter++;</span><br><span class="line">                        &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            foreach (MethodInvoker t in list)</span><br><span class="line">            &#123;</span><br><span class="line">                t(); //执行全部5个委托</span><br><span class="line">            &#125;</span><br><span class="line">            list[0]();</span><br><span class="line">            list[0]();</span><br><span class="line">            list[0]();</span><br><span class="line">            list[1]();</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>####5.5.6 Mixtures of shared and distinct variables</p>
<blockquote>
<p>list 5.14 Capturing variables in different scopes. Warning : nasty code ahead!<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MethodInvoker[] delegates = new MethodInvoker[2];</span><br><span class="line">           int outside = 0;           //Instatiates variable once</span><br><span class="line">           for (int i = 0; i &lt; 2; i++)</span><br><span class="line">           &#123;</span><br><span class="line">               int inside = 0;        //Instatiates variable multiple times</span><br><span class="line">               delegates[i] = delegate  //Captures variables with anonymous method</span><br><span class="line">                   &#123;</span><br><span class="line">                       Console.WriteLine(&quot;(&#123;0&#125;,&#123;1&#125;)&quot;, outside, inside);</span><br><span class="line">                       outside++;</span><br><span class="line">                       inside++;</span><br><span class="line">                   &#125;;</span><br><span class="line">           &#125;</span><br><span class="line">           MethodInvoker first = delegates[0];</span><br><span class="line">           MethodInvoker second = delegates[1];</span><br><span class="line">           first();</span><br><span class="line">           first();</span><br><span class="line">           first();</span><br><span class="line">           second();</span><br><span class="line">           second();</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>####5.5.7 Captured variable guidelines and summary</p>
<ul>
<li>If Code that doesnot use captured variables is just as simple as code that does,dont use them</li>
<li>Before capturing a variable declared by a for or foreach statement,consider whether your delegate is going to live beyont the loop iteration, and whether your want it to see the subsequent values of that variable. If not ,create another variable inside the loop that just copies the value you do want</li>
<li>If you create multiple delegate instances that capture variables, put thought into whether your want them to capture the same variable</li>
<li>If you capture avariable that doesnt actually change,you dont need to worry as much</li>
<li>If the delegate instances your create never escape from the method - in other words,they’re never stored anywhere else,or returned, or used for starting threads-life is a lot simple</li>
<li>Consider the extended lifetie of any  captured variables in terms of garbage collection. This is normally not an issue,but if you capture an object that’s expensive in terms of memory, it may be significant’<h3 id="5-6-Summary"><a href="#5-6-Summary" class="headerlink" title="5.6 Summary"></a>5.6 Summary</h3></li>
<li>The varibale is captured - not its value at the point of delegate instance creation</li>
<li>Captured variables have lifetimes extended to at least that of the capturing delegate</li>
<li>Multiple delegates can capture the same variable…</li>
<li>…but within loops,the same variable declaration can effectively refer to different variable “instances”</li>
<li>for loop declarations careate variable that live for the duration of the loop– they are not instantiated on each iteration. the same is true for foreach statements before C#5</li>
<li>Extra types are created ,where necessary,to hold captured variable.</li>
<li>Be careful! Simple is almost always better than clever.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">木兰花令·拟古决绝词</span><br><span class="line">人生若只如初见，何事秋风悲画扇。</span><br><span class="line">等闲变却故人心，却道故人心易变。</span><br><span class="line">骊山语罢清宵半，泪雨零铃终不怨。</span><br><span class="line">何如薄幸锦衣郎，比翼连枝当日愿。</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/29/WPF-Web-Review/" rel="next" title="WPF-Web-Review">
                <i class="fa fa-chevron-left"></i> WPF-Web-Review
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/10/pixiv-dns/" rel="prev" title="pixiv_dns">
                pixiv_dns <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Psmyfish</p>
              <p class="site-description motion-element" itemprop="description">Some fish in the rain,some fish in the sun.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#C-in-Depth"><span class="nav-number">1.</span> <span class="nav-text">C# in Depth</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#The-changing-face-of-C-development"><span class="nav-number">1.1.</span> <span class="nav-text">The changing face of C# development</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Starting-with-a-simple-data-type"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1 Starting with a simple data type</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-1-The-Product-type-in-C-1"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">1.1.1 The Product type in C#1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-2-Strongly-typed-collections-in-C-2"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">1.1.2 Strongly typed collections in C#2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-3-Automatically-implemented-properties-in-C-3"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">1.1.3 Automatically implemented properties in C#3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-4-Name-arguments-in-C-4"><span class="nav-number">1.1.1.4.</span> <span class="nav-text">1.1.4 Name arguments in C# 4</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Sorting-and-filtering"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2 Sorting and filtering</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-Sorting-products-by-name"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">1.2.1 Sorting products by name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-Querying-collections"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">1.2.2 Querying collections</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-1-Representing-an-unknown-price"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">1.3.1 Representing an unknown price</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-2-Optional-parameters-and-default-values"><span class="nav-number">1.1.2.4.</span> <span class="nav-text">1.3.2 Optional parameters and default values</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-Introducing-LINQ"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.4 Introducing LINQ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-1-Query-expressions-and-in-process-queries"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">1.4.1 Query expressions and in-process queries</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Core-foundations-building-on-C-1"><span class="nav-number">1.2.</span> <span class="nav-text">Core foundations:building on C#1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Delegates"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 Delegates</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-A-recipe-for-simple-delegates"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">2.1.1 A recipe for simple delegates</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-Combining-and-removing-delegates"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">2.1.2 Combining and removing delegates</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-A-brief-diversion-into-events"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">2.1.3 A brief diversion into events</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-4-Summary-of-delegates"><span class="nav-number">1.2.1.4.</span> <span class="nav-text">2.1.4 Summary of delegates</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Type-system-characteristics"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2  Type system characteristics</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-C-’s-place-in-the-world-of-type-systems"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">2.2.1 C#’s place in the world of type systems</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#STATIC-TYPING-VERSUS-DYNAMIC-TYPING"><span class="nav-number">1.2.2.1.1.</span> <span class="nav-text">STATIC TYPING VERSUS DYNAMIC TYPING</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EXPLICIT-TYPING-VERSUS-IMPLICIT-TYPING"><span class="nav-number">1.2.2.1.2.</span> <span class="nav-text">EXPLICIT TYPING VERSUS IMPLICIT TYPING</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#TYPE-SAFE-VERSUS-TYPE-UNSAFE"><span class="nav-number">1.2.2.1.3.</span> <span class="nav-text">TYPE-SAFE VERSUS TYPE-UNSAFE</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-When-is-C-1’s-type-ststem-not-rich-enough"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">2.2.2 When is C# 1’s type ststem not rich enough?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-Summary-of-type-system-characteristics"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">2.2.3 Summary of type system characteristics</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-Value-types-and-reference-types"><span class="nav-number">1.3.</span> <span class="nav-text">2.3 Value types and reference types</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-Values-and-references-in-the-real-world"><span class="nav-number">1.3.0.1.</span> <span class="nav-text">2.3.1 Values and references in the real world</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-Value-and-reference-type-fundamentals"><span class="nav-number">1.3.0.2.</span> <span class="nav-text">2.3.2 Value and reference type fundamentals</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-Dispelling-myths"><span class="nav-number">1.3.0.3.</span> <span class="nav-text">2.3.3 Dispelling myths</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-4-Boxing-and-unboxing"><span class="nav-number">1.3.0.4.</span> <span class="nav-text">2.3.4 Boxing and unboxing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-5-值类型和引用类型小结"><span class="nav-number">1.3.0.5.</span> <span class="nav-text">2.3.5 值类型和引用类型小结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-C-1之外-构建于坚实基础之上的新特性"><span class="nav-number">1.3.1.</span> <span class="nav-text">2.4 C#1之外:构建于坚实基础之上的新特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-与委托有关的特性"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">2.4.1 与委托有关的特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-Features-related-to-value-types"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">2.4.2 Features related to value types</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Parameterized-typing-with-generics"><span class="nav-number">1.4.</span> <span class="nav-text">3  Parameterized typing with generics</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-why-generics-are-necessary"><span class="nav-number">1.4.1.</span> <span class="nav-text">3.1 why generics are necessary</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-2-Generic-types-and-type-parameters"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">3.2.2  Generic types and type parameters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-3-Generic-methods-and-reading-generic-declarations"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">3.2.3 Generic methods and reading generic declarations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-Type-constraints"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">3.3.1 Type constraints</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-Type-inference-for-type-arguments-of-generic-methods"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">3.3.2 Type inference for type arguments of generic methods</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-Implementing-generics"><span class="nav-number">1.4.1.5.</span> <span class="nav-text">3.3.3 Implementing generics</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Advanced-generics"><span class="nav-number">1.4.2.</span> <span class="nav-text">3.4 Advanced generics</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-Static-fields-and-static-constructors"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">3.4.1 Static fields and static constructors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-2-How-the-JIT-compiler-handles-generics"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">3.4.2 How the JIT compiler handles generics</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-3-Generic-iteration"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">3.4.3 Generic iteration</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-4-Reflection-and-generics"><span class="nav-number">1.4.2.4.</span> <span class="nav-text">3.4.4 Reflection and generics</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-Limitations-of-generics-in-C-and-other-languages"><span class="nav-number">1.4.3.</span> <span class="nav-text">3.5 Limitations of generics in C# and other languages</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-1-Lack-of-generic-variance"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">3.5.1 Lack of generic variance</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Saying-nothing-with-nullable-types"><span class="nav-number">1.5.</span> <span class="nav-text">4 Saying nothing with nullable types</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-What-do-you-do-when-you-just-dont-have-a-value"><span class="nav-number">1.5.1.</span> <span class="nav-text">4.1 What do you do when you  just dont have a value?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-1-Why-value-type-variables-cant-be-null"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">4.1.1 Why value type variables cant be null</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-2-Patterns-for-representing-null-values-in-C-1"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">4.1.2 Patterns for representing null values in C#1</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-System-Nullable-lt-T-gt-and-System-Nullable"><span class="nav-number">1.5.2.</span> <span class="nav-text">4.2 System.Nullable &lt;T&gt;and System.Nullable</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-1-Introduciong-Nullable-lt-T-gt"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">4.2.1 Introduciong Nullable&lt;T&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-2-Boxing-Nullable-lt-T-gt-and-unboxing"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">4.2.2 Boxing Nullable&lt;T&gt; and unboxing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-3-Equality-of-Nullable-lt-T-gt-instances"><span class="nav-number">1.5.2.3.</span> <span class="nav-text">4.2.3 Equality of Nullable&lt;T&gt; instances</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-4-Support-from-the-nongeneric-Nullable-class"><span class="nav-number">1.5.2.4.</span> <span class="nav-text">4.2.4 Support from the nongeneric Nullable class</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-C-2’s-syntactic-sugar-for-nullable-types"><span class="nav-number">1.5.3.</span> <span class="nav-text">4.3 C# 2’s syntactic sugar for nullable types</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-1-The-modifier"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">4.3.1 The ? modifier</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-Assigning-and-comparing-with-null"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">4.3.2 Assigning and comparing with null</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-3-Nullable-conversions-and-operators"><span class="nav-number">1.5.3.3.</span> <span class="nav-text">4.3.3 Nullable conversions and operators</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-4-Nullable-logic"><span class="nav-number">1.5.3.4.</span> <span class="nav-text">4.3.4 Nullable logic</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-5-Using-the-as-operator-with-nullable-types"><span class="nav-number">1.5.3.5.</span> <span class="nav-text">4.3.5  Using the as operator with nullable types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-6-The-null-coalescing-operator"><span class="nav-number">1.5.3.6.</span> <span class="nav-text">4.3.6 The null coalescing operator</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-Novel-uses-of-nullable-types"><span class="nav-number">1.5.4.</span> <span class="nav-text">4.4 Novel uses of nullable types</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-1-Tyeing-an-operation-without-using-output-parameter"><span class="nav-number">1.5.4.1.</span> <span class="nav-text">4.4.1 Tyeing an operation without using output parameter</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-Summary"><span class="nav-number">1.5.5.</span> <span class="nav-text">4.5 Summary</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Fast-tracked-delegates"><span class="nav-number">1.6.</span> <span class="nav-text">5 Fast-tracked delegates</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-Saying-goodbye-to-awkward-delegate-syntax"><span class="nav-number">1.6.1.</span> <span class="nav-text">5.1 Saying goodbye to awkward delegate syntax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-Method-group-conversions"><span class="nav-number">1.6.2.</span> <span class="nav-text">5.2 Method group conversions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-Covariance-and-contravariance"><span class="nav-number">1.6.3.</span> <span class="nav-text">5.3 Covariance and contravariance</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-Contravariance-for-delegate-parameters"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">5.3.1 Contravariance for delegate parameters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-Covariance-of-delegate-return-types"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">5.3.2 Covariance of delegate return types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-3-A-small-risk-of-incompatibility"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">5.3.3 A small risk of incompatibility</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-Inline-delegate-actions-with-anonymous-methods"><span class="nav-number">1.6.4.</span> <span class="nav-text">5.4 Inline delegate actions with anonymous methods</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-1-Starting-simply-acting-on-a-parameter"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">5.4.1 Starting simply : acting on a parameter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-2-Returing-values-from-anonymous-methods"><span class="nav-number">1.6.4.2.</span> <span class="nav-text">5.4.2 Returing values from anonymous methods</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-3-Ignoring-delegate-parameters"><span class="nav-number">1.6.4.3.</span> <span class="nav-text">5.4.3 Ignoring delegate parameters</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-5-Capturing-variables-in-anonymous-methods"><span class="nav-number">1.6.5.</span> <span class="nav-text">5.5 Capturing variables in anonymous methods</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-5-1-Defining-closures-and-different-types-of-variables"><span class="nav-number">1.6.5.1.</span> <span class="nav-text">5.5.1 Defining closures and different types of variables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-5-2-Examining-the-behavior-of-captured-variables"><span class="nav-number">1.6.5.2.</span> <span class="nav-text">5.5.2 Examining the behavior of captured variables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-5-3-What’s-the-point-of-captured-variables"><span class="nav-number">1.6.5.3.</span> <span class="nav-text">5.5.3 What’s the point of captured variables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-5-4-The-extended-lifetime-of-captured-variables"><span class="nav-number">1.6.5.4.</span> <span class="nav-text">5.5.4 The extended lifetime of  captured variables</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-6-Summary"><span class="nav-number">1.6.6.</span> <span class="nav-text">5.6 Summary</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Psmyfish</span>

  
</div>






  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
